<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a1428">
    <meta name="screen-orientation" content="landscape">
    <title>ÂÆûÂÜµË∂≥ÁêÉÊâãÊú∫Áâà - ÁêÉÂëòÊäΩÂç°Ê®°ÊãüÂô®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            height: calc(var(--vh, 1vh) * 100);
            overflow: hidden;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #0a1428 0%, #1e3c72 50%, #2a5298 100%);
            min-height: 100vh;
            min-height: calc(var(--vh, 1vh) * 100);
            color: #fff;
            overflow-x: hidden;
            position: fixed;
            width: 100vw;
            height: 100vh;
            height: calc(var(--vh, 1vh) * 100);
        }

        /* ÁßªÂä®Á´ØÊ®™Â±èÊèêÁ§∫ - Âè™Âú®ÊâãÊú∫Á´ñÂ±èÊó∂ÊòæÁ§∫ */
        @media screen and (orientation: portrait) and (max-width: 768px) {
            .orientation-notice {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: rgba(0, 0, 0, 0.95);
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                color: white;
                text-align: center;
                padding: 20px;
            }
            
            .orientation-notice .rotate-icon {
                font-size: 80px;
                margin-bottom: 20px;
                animation: rotate 2s infinite linear;
            }
            
            /* Á´ñÂ±èÊó∂ÈöêËóè‰∏ªÁïåÈù¢ */
            .top-bar, .container {
                display: none;
            }
        }

        /* Ê°åÈù¢Á´ØÂíåÊ®™Â±èÊó∂ÈöêËóèÊ®™Â±èÊèêÁ§∫ */
        @media screen and (min-width: 769px), 
               screen and (orientation: landscape) {
            .orientation-notice {
                display: none !important;
            }
        }

        /* CSSÂä®ÁîªÂÆö‰πâ */
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ÁßªÂä®Á´ØËß¶Êë∏‰ºòÂåñ */
        button, .pool-card, .player-card {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        /* ÈöêËóèÊªöÂä®Êù°‰ΩÜ‰øùÊåÅÊªöÂä®ÂäüËÉΩ */
        .container {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .container::-webkit-scrollbar {
            display: none;
        }

        /* ÁßªÂä®Á´ØÊ®™Â±è‰ºòÂåñ */
        @media screen and (orientation: landscape) and (max-height: 600px) {
            .top-bar {
                padding: 5px 15px;
                font-size: 14px;
            }
            
            .logo {
                font-size: 18px;
            }
            
            .container {
                padding: 10px;
                max-width: none;
                height: calc(100vh - 60px);
                height: calc(var(--vh, 1vh) * 100 - 60px);
                overflow-y: auto;
                overflow-x: hidden;
            }
            
            .hero-section {
                margin-bottom: 20px;
            }
            
            .hero-title {
                font-size: 24px;
            }
            
            .hero-subtitle {
                font-size: 12px;
            }
            
            .pools-container {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 15px;
            }
            
            .pool-card {
                min-height: 200px;
            }
            
            .pool-title {
                font-size: 16px;
                margin-bottom: 8px;
            }
            
            .pool-subtitle {
                font-size: 12px;
            }
            
            .gacha-controls {
                padding: 15px;
            }
            
            .gacha-button {
                padding: 8px 16px;
                font-size: 14px;
                margin: 5px;
                min-width: 100px;
            }
        }

        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        .top-bar {
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #00d4ff;
        }

        .currency-display {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .currency-item {
            display: flex;
            align-items: center;
            gap: 5px;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex-direction: column;
            text-align: center;
        }

        .currency-item small {
            font-size: 10px;
            opacity: 0.8;
        }

        .coin-icon {
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #ffd700, #ffb300);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            color: #8b4513;
        }

        /* ‰∏ªÂÆπÂô® */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            height: calc(100vh - 60px);
            height: calc(var(--vh, 1vh) * 100 - 60px);
            overflow-y: auto;
            overflow-x: hidden;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .hero-title {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }

        .hero-subtitle {
            font-size: 18px;
            color: #b0c4de;
            margin-bottom: 30px;
        }

        /* ÊäΩÂç°ÊåâÈíÆÂå∫Âüü */
        .gacha-buttons {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-bottom: 40px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }

        .pool-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .pool-section h3 {
            color: #00d4ff;
            text-align: center;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
        }

        .pool-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .pity-counter {
            text-align: center;
            margin-top: 15px;
            color: #ffd700;
            font-size: 14px;
            font-weight: bold;
        }

        .gacha-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            position: relative;
            overflow: hidden;
            min-width: 120px;
        }

        .gacha-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .gacha-btn.highlight-pool {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .gacha-btn.featured-pool {
            background: linear-gradient(135deg, #ffd700, #ffb300);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            color: #333;
        }

        .gacha-btn.highlight-normal {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            box-shadow: 0 4px 15px rgba(255, 154, 158, 0.3);
        }

        .gacha-btn.featured-normal {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            box-shadow: 0 4px 15px rgba(168, 237, 234, 0.3);
            color: #333;
        }

        .gacha-btn.inventory-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .gacha-btn.release-btn {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);
        }

        .star-rating {
            font-size: 14px;
            margin-top: 10px;
        }

        .new-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff4757;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            animation: pulse 1s infinite;
        }

        .pity-badge {
            position: absolute;
            top: 45px;
            right: 10px;
            background: #ffd700;
            color: #333;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            animation: pity-glow 1.5s ease-in-out infinite alternate;
        }

        @keyframes pity-glow {
            from { box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
            to { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .card-buttons {
            padding: 10px;
            text-align: center;
        }

        .card-buttons .release-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .card-buttons .release-btn:hover {
            background: #ff3838;
            transform: scale(1.05);
        }

        /* ÁêÉÂëòÂç°ÁâáÂÆπÂô® */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        /* ÁêÉÂëòÂç°Áâá */
        .player-card {
            width: 280px;
            height: 400px;
            margin: 0 auto;
            perspective: 1000px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .player-card:hover {
            transform: translateY(-5px) scale(1.02);
            filter: brightness(1.1);
            cursor: pointer;
        }

        .player-card:hover .click-hint-small {
            animation: clickPulse 0.5s ease-in-out infinite;
            background: rgba(255, 255, 255, 0.2);
            color: #ffd700;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .card-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .card-back {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            transform: rotateY(180deg);
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* Á•ûÁßòÂç°ÁâáËÉåÈù¢Ê†∑Âºè */
        .mystery-card-back {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            overflow: hidden;
        }

        .mystery-content {
            text-align: center;
            z-index: 2;
            position: relative;
        }

        .pes-logo {
            font-size: 48px;
            margin-bottom: 10px;
            animation: logoFloat 2s ease-in-out infinite;
        }

        .mystery-content h3 {
            font-size: 24px;
            font-weight: bold;
            color: white;
            margin: 10px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .mystery-content p {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            margin: 5px 0;
        }

        .click-hint {
            margin-top: 20px;
            animation: clickPulse 1.5s ease-in-out infinite;
        }

        .click-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .click-hint p {
            font-size: 14px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .click-hint-small {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            background: rgba(0, 0, 0, 0.3);
            padding: 4px 8px;
            border-radius: 10px;
            animation: clickPulse 2s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes clickPulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        /* Á®ÄÊúâÂ∫¶Ê†∑Âºè - Êõ¥Êñ∞‰∏∫Êñ∞ÁöÑÂç°Ê±†Á≥ªÁªü */
        .normal-card { 
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); 
            color: #333; 
            border: 2px solid #6c757d;
        }
        .dream-featured { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            border: 2px solid #764ba2;
            box-shadow: 0 0 20px rgba(118, 75, 162, 0.5);
        }
        .featured { 
            background: linear-gradient(135deg, #ffd700 0%, #ffb300 100%); 
            color: #333; 
            border: 2px solid #ff8f00;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }
        .highlight { 
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); 
            border: 2px solid #ff4757;
            box-shadow: 0 0 25px rgba(255, 107, 107, 0.7);
            animation: highlight-glow 2s ease-in-out infinite alternate;
        }
        .legend-highlight { 
            background: linear-gradient(135deg, #8b00ff 0%, #4b0082 100%); 
            border: 2px solid #9400d3;
            box-shadow: 0 0 30px rgba(139, 0, 255, 0.8);
            animation: legend-glow 1.5s ease-in-out infinite alternate;
        }

        @keyframes highlight-glow {
            from { box-shadow: 0 0 25px rgba(255, 107, 107, 0.7); }
            to { box-shadow: 0 0 35px rgba(255, 107, 107, 0.9); }
        }

        @keyframes legend-glow {
            from { box-shadow: 0 0 30px rgba(139, 0, 255, 0.8); }
            to { box-shadow: 0 0 40px rgba(139, 0, 255, 1.0); }
        }

        .card-header {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            text-align: center;
        }

        .rarity-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .player-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .player-overall {
            font-size: 36px;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .card-body {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
        }

        .player-info {
            text-align: center;
        }

        .player-position {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .player-club {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .player-nationality {
            font-size: 14px;
            opacity: 0.8;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }

        /* ÁªìÊûúÊòæÁ§∫Âå∫Âüü */
        .result-area {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .result-title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            color: #00d4ff;
        }

        /* Âä®ÁîªÊïàÊûú */
        @keyframes cardFlip {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(-90deg); }
            100% { transform: rotateY(0deg); }
        }

        .flip-animation {
            animation: cardFlip 1s ease-in-out;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 50%;
            animation: sparkle 1.5s infinite;
        }

        /* ÂÖÖÂÄºÁïåÈù¢Ê†∑Âºè */
        .recharge-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .recharge-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .recharge-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .recharge-title {
            font-size: 28px;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
        }

        .recharge-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            transform: scale(1.2);
            color: #ff6b6b;
        }

        .recharge-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .recharge-option {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .recharge-option:hover {
            transform: translateY(-5px);
            border-color: #ffd700;
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .recharge-option.highlight-directed {
            border-color: #ff6b6b;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.3), rgba(238, 90, 82, 0.3));
        }

        .recharge-option.featured-directed {
            border-color: #ffd700;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 179, 0, 0.3));
        }

        .recharge-option.highlight-normal {
            border-color: #ff9500;
            background: linear-gradient(135deg, rgba(255, 149, 0, 0.3), rgba(255, 123, 0, 0.3));
        }

        .recharge-option.featured-normal {
            border-color: #4facfe;
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.3), rgba(0, 242, 254, 0.3));
        }

        .recharge-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .recharge-name {
            font-size: 18px;
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
        }

        .recharge-price {
            font-size: 20px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }

        .recharge-quantity {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .purchase-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            border: none;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .purchase-btn:hover {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(116, 185, 255, 0.4);
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 24px;
            }

            .pool-buttons {
                flex-direction: column;
                align-items: center;
            }

            .gacha-btn {
                width: 200px;
                margin: 5px 0;
            }

            .cards-container {
                grid-template-columns: 1fr;
            }

            .player-card {
                width: 100%;
                max-width: 300px;
            }

            .pool-section {
                padding: 15px;
                margin: 10px;
            }

            .pool-section h3 {
                font-size: 16px;
            }

            .currency-display {
                flex-wrap: wrap;
                gap: 10px;
            }

            .currency-item {
                min-width: 80px;
            }
        }

        /* ÊäΩÂç°Âä®ÁîªÁ≥ªÁªü */
        .gacha-animation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999;
            background: #000;
            display: none;
            overflow: hidden;
        }

        .stadium-container {
            position: absolute;
            width: 100%;
            height: 100%;
            perspective: 2000px;
            transform-style: preserve-3d;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .stadium {
            position: relative;
            width: 1000px;
            height: 600px;
            background: 
                radial-gradient(ellipse at center, #2d5016 0%, #1a3009 40%, #0f1d05 80%, #000 100%);
            border-radius: 50%;
            box-shadow: 
                0 0 200px rgba(45, 80, 22, 0.8),
                inset 0 0 400px rgba(0, 0, 0, 0.6),
                0 50px 100px rgba(0, 0, 0, 0.8);
            animation: stadiumZoom 3s ease-out forwards;
            transform-origin: center center;
            overflow: hidden;
        }

        @keyframes stadiumZoom {
            0% { 
                transform: rotateX(85deg) scale(0.03) translateZ(-600px); 
                opacity: 0;
                filter: blur(25px);
            }
            20% { 
                transform: rotateX(80deg) scale(0.15) translateZ(-400px); 
                opacity: 0.2;
                filter: blur(18px);
            }
            40% { 
                transform: rotateX(70deg) scale(0.4) translateZ(-250px); 
                opacity: 0.5;
                filter: blur(12px);
            }
            65% { 
                transform: rotateX(55deg) scale(0.7) translateZ(-100px); 
                opacity: 0.75;
                filter: blur(6px);
            }
            85% { 
                transform: rotateX(40deg) scale(0.9) translateZ(-20px); 
                opacity: 0.9;
                filter: blur(2px);
            }
            100% { 
                transform: rotateX(35deg) scale(1) translateZ(0px); 
                opacity: 1;
                filter: blur(0px);
            }
        }

        /* Êñ∞Â¢ûÂä®ÁîªÔºö‰ΩìËÇ≤Âú∫ÈúáÂä®ÊïàÊûú */
        @keyframes stadiumVibration {
            0%, 100% { transform: rotateX(35deg) scale(1) translateZ(0px); }
            25% { transform: rotateX(35deg) scale(1.002) translateZ(2px) translateX(1px); }
            50% { transform: rotateX(35deg) scale(1.001) translateZ(-1px) translateX(-1px); }
            75% { transform: rotateX(35deg) scale(1.003) translateZ(1px) translateX(0.5px); }
        }

        /* Êñ∞Â¢ûÂä®ÁîªÔºöÁõ∏Êú∫Êé®ËøõÊïàÊûú */
        @keyframes cameraZoomIn {
            0% { transform: rotateX(35deg) scale(1) translateZ(0px); }
            100% { transform: rotateX(30deg) scale(1.1) translateZ(20px); }
        }

        /* Êñ∞Â¢ûÂä®ÁîªÔºöÁ≤íÂ≠êÈ£òÊï£ÊïàÊûú */
        @keyframes cheerParticle {
            0% { 
                opacity: 1; 
                transform: translateY(0) translateX(0) scale(1); 
            }
            50% { 
                opacity: 0.7; 
                transform: translateY(-30px) translateX(var(--random-x, 0)) scale(1.2); 
            }
            100% { 
                opacity: 0; 
                transform: translateY(-60px) translateX(var(--random-x, 0)) scale(0.8); 
            }
        }

        /* Êñ∞Â¢ûÂä®ÁîªÔºöÁéØÂ¢ÉÂÖâËÑâÂÜ≤ */
        @keyframes ambientPulse {
            0%, 100% { opacity: 0.3; filter: blur(10px); }
            50% { opacity: 0.6; filter: blur(15px); }
        }

        .stadium-field {
            position: absolute;
            width: 70%;
            height: 85%;
            left: 15%;
            top: 7.5%;
            background: 
                linear-gradient(90deg, 
                    #2d5016 0%, #3d6b1f 10%, #2d5016 20%, 
                    #3d6b1f 30%, #2d5016 40%, #3d6b1f 50%,
                    #2d5016 60%, #3d6b1f 70%, #2d5016 80%,
                    #3d6b1f 90%, #2d5016 100%);
            border-radius: 20px;
            border: 4px solid #ffffff;
            box-shadow: 
                inset 0 0 50px rgba(255, 255, 255, 0.1),
                0 0 30px rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        /* Ë∂≥ÁêÉÂú∫Ê†áÁ∫ø */
        .field-lines {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }

        .center-circle {
            position: absolute;
            width: 80px;
            height: 80px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 50%;
        }

        .penalty-area {
            position: absolute;
            width: 60px;
            height: 120px;
            border: 2px solid rgba(255, 255, 255, 0.6);
            top: 50%;
            transform: translateY(-50%);
        }

        .penalty-area.left { left: 0; }
        .penalty-area.right { right: 0; }

        .stadium-lights {
            position: absolute;
            width: 120%;
            height: 120%;
            left: -10%;
            top: -10%;
            border-radius: 50%;
            z-index: 2;
        }

        .light-strip {
            position: absolute;
            border-radius: 4px;
            opacity: 0;
            animation: lightPulse 0.8s ease-in-out forwards;
            box-shadow: 0 0 30px currentColor;
        }

        .light-strip.top { 
            top: 5%; 
            left: 10%;
            right: 10%;
            height: 8px;
        }
        .light-strip.bottom { 
            bottom: 5%; 
            left: 10%;
            right: 10%;
            height: 8px;
        }
        .light-strip.left { 
            left: 5%; 
            top: 10%;
            bottom: 10%;
            width: 8px;
        }
        .light-strip.right { 
            right: 5%; 
            top: 10%;
            bottom: 10%;
            width: 8px;
        }

        @keyframes lightPulse {
            0% { 
                opacity: 0; 
                transform: scale(0.2);
                filter: blur(10px);
            }
            50% { 
                opacity: 1; 
                transform: scale(1.5);
                filter: blur(0px);
            }
            100% { 
                opacity: 0.9; 
                transform: scale(1);
                filter: blur(0px);
            }
        }

        /* Êõ¥Âçé‰∏ΩÁöÑÁ®ÄÊúâÂ∫¶È¢úËâ≤ */
        .rarity-normal { 
            background: linear-gradient(45deg, #6c757d, #adb5bd, #6c757d);
            background-size: 200% 200%;
            animation: normalGlow 2s ease-in-out infinite;
        }
        .rarity-dream { 
            background: linear-gradient(45deg, #667eea, #764ba2, #a8e6cf, #667eea);
            background-size: 300% 300%;
            animation: dreamGlow 2s ease-in-out infinite;
        }
        .rarity-featured { 
            background: linear-gradient(45deg, #ffd700, #ffb300, #fff700, #ffd700);
            background-size: 300% 300%;
            animation: featuredGlow 2s ease-in-out infinite;
        }
        .rarity-highlight { 
            background: linear-gradient(45deg, #ff6b6b, #ee5a52, #ff9ff3, #ff6b6b);
            background-size: 300% 300%;
            animation: highlightGlow 2s ease-in-out infinite;
        }
        .rarity-legend { 
            background: linear-gradient(45deg, #8b00ff, #4b0082, #da70d6, #8b00ff);
            background-size: 300% 300%;
            animation: legendGlow 2s ease-in-out infinite;
        }
        .rarity-galaxy { 
            background: linear-gradient(45deg, 
                #ff0080, #ff8c00, #ffd700, #00ff80, #00bfff, #8a2be2, #ff1493, #ff0080);
            background-size: 800% 800%;
            animation: galaxyFlow 1s ease-in-out infinite;
            box-shadow: 0 0 50px currentColor;
        }

        @keyframes normalGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes dreamGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes featuredGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes highlightGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes legendGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes galaxyFlow {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 50% 100%; }
            75% { background-position: 0% 50%; }
        }

        /* LED Â§©È°∂ */
        .stadium-led {
            position: absolute;
            width: 100%;
            height: 100%;
            top: -80px;
            border-radius: 50%;
            background: 
                radial-gradient(circle at center, transparent 50%, rgba(255, 255, 255, 0.05) 60%, transparent 70%);
            overflow: hidden;
            z-index: 3;
        }

        .led-pixel {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            opacity: 0;
            animation: ledTwinkle 0.5s ease-in-out forwards;
            box-shadow: 0 0 20px currentColor;
        }

        @keyframes ledTwinkle {
            0% { 
                opacity: 0; 
                transform: scale(0) rotate(0deg);
            }
            50% { 
                opacity: 1; 
                transform: scale(2) rotate(180deg);
            }
            100% { 
                opacity: 0.8; 
                transform: scale(1) rotate(360deg);
            }
        }

        /* Êõ¥Âçé‰∏ΩÁöÑÁÉüËä±ÊïàÊûú */
        .firework {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: fireworkExplode 2s ease-out forwards;
            box-shadow: 0 0 20px currentColor;
        }

        @keyframes fireworkExplode {
            0% { 
                transform: scale(0) rotate(0deg); 
                opacity: 1; 
            }
            20% { 
                transform: scale(2) rotate(72deg); 
                opacity: 1; 
            }
            40% { 
                transform: scale(4) rotate(144deg); 
                opacity: 0.8; 
            }
            60% { 
                transform: scale(6) rotate(216deg); 
                opacity: 0.6; 
            }
            80% { 
                transform: scale(8) rotate(288deg); 
                opacity: 0.4; 
            }
            100% { 
                transform: scale(10) rotate(360deg); 
                opacity: 0; 
            }
        }

        /* ÊøÄÂÖâÊùüÊïàÊûú */
        .laser-beam {
            position: absolute;
            width: 2px;
            height: 100vh;
            background: linear-gradient(to bottom, 
                transparent 0%, 
                currentColor 20%, 
                currentColor 80%, 
                transparent 100%);
            opacity: 0;
            animation: laserSweep 3s ease-in-out infinite;
            box-shadow: 0 0 30px currentColor;
        }

        @keyframes laserSweep {
            0%, 100% { 
                opacity: 0; 
                transform: translateX(-100vw) rotate(-5deg);
            }
            50% { 
                opacity: 0.8; 
                transform: translateX(100vw) rotate(5deg);
            }
        }

        /* ËÉΩÈáèÊ≥¢Á∫π */
        .energy-ring {
            position: absolute;
            border: 3px solid currentColor;
            border-radius: 50%;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            animation: energyExpand 2s ease-out forwards;
            box-shadow: 0 0 30px currentColor, inset 0 0 30px currentColor;
        }

        @keyframes energyExpand {
            0% { 
                width: 0; 
                height: 0; 
                opacity: 1; 
            }
            100% { 
                width: 150%; 
                height: 150%; 
                opacity: 0; 
            }
        }

        /* ÁªìÊûúÂ±ïÁ§∫Âå∫Âüü */
        .result-showcase {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            animation: showcaseAppear 1s ease-out 3s forwards;
        }

        @keyframes showcaseAppear {
            0% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(0.3) rotateY(180deg); 
            }
            100% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1) rotateY(0deg); 
            }
        }

        .best-player-card {
            transform: scale(1.2);
            box-shadow: 0 0 50px rgba(255, 255, 255, 0.8);
            animation: cardGlow 2s ease-in-out infinite alternate;
        }

        @keyframes cardGlow {
            0% { 
                box-shadow: 0 0 50px rgba(255, 255, 255, 0.8);
                filter: brightness(1);
            }
            100% { 
                box-shadow: 0 0 80px rgba(255, 255, 255, 1);
                filter: brightness(1.2);
            }
        }

        /* Âä®ÁîªËøõÂ∫¶Êù° */
        .animation-progress-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1000;
            overflow: hidden;
        }

        .animation-progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, 
                #00f2fe 0%, 
                #4facfe 25%, 
                #00f2fe 50%, 
                #4facfe 75%, 
                #00f2fe 100%);
            transition: width 0.1s linear;
            box-shadow: 0 0 10px rgba(79, 172, 254, 0.5);
        }

        /* ËøõÂ∫¶Êù°Èò∂ÊÆµÊÄßÈ¢úËâ≤ÂèòÂåñ */
        .animation-progress-bar.stage-atmosphere {
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .animation-progress-bar.stage-lights {
            background: linear-gradient(90deg, #ff9800, #ffc107);
            box-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
        }

        .animation-progress-bar.stage-camera {
            background: linear-gradient(90deg, #9c27b0, #e91e63);
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
        }

        .animation-progress-bar.stage-rarity {
            background: linear-gradient(90deg, #f44336, #ff5722);
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }

        .animation-progress-bar.stage-result {
            background: linear-gradient(90deg, #ffd700, #ffeb3b);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }

        .animation-progress-glow {
            position: absolute;
            top: -2px;
            left: 0;
            height: 8px;
            width: 20px;
            background: radial-gradient(ellipse, 
                rgba(255, 255, 255, 0.8) 0%, 
                rgba(79, 172, 254, 0.6) 50%, 
                transparent 100%);
            border-radius: 50%;
            animation: progressGlow 2s ease-in-out infinite;
            opacity: 0;
        }

        @keyframes progressGlow {
            0%, 100% { 
                transform: translateX(-10px) scale(0.8); 
                opacity: 0.3; 
            }
            50% { 
                transform: translateX(10px) scale(1.2); 
                opacity: 0.8; 
            }
        }

        /* Ë∑≥ËøáÊåâÈíÆ */
        .skip-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border: 2px solid #ffd700;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0;
            transform: translateY(50px);
            animation: skipButtonAppear 0.5s ease-out 1s forwards;
            backdrop-filter: blur(10px);
            z-index: 10000;
        }

        @keyframes skipButtonAppear {
            0% { 
                opacity: 0; 
                transform: translateY(50px); 
            }
            100% { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .skip-button:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }

        /* 3D Á≤íÂ≠êÊïàÊûú - Êõ¥ÁºìÊÖ¢ÊüîÂíå */
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, #fff, #e3f2fd);
            border-radius: 50%;
            pointer-events: none;
            animation: particleFloat 5s ease-in-out infinite; /* Âª∂ÈïøÂà∞5ÁßíÔºåÊîπ‰∏∫ease-in-out */
            box-shadow: 0 0 6px rgba(255, 255, 255, 0.5);
        }

        @keyframes particleFloat {
            0% { 
                transform: translateY(100vh) translateX(0) rotate(0deg) scale(0.3); 
                opacity: 0; 
            }
            15% { 
                opacity: 0.8; 
                transform: translateY(80vh) translateX(10px) rotate(45deg) scale(0.8);
            }
            50% { 
                opacity: 1; 
                transform: translateY(40vh) translateX(-5px) rotate(180deg) scale(1);
            }
            85% { 
                opacity: 0.8; 
                transform: translateY(10vh) translateX(15px) rotate(315deg) scale(0.9);
            }
            100% { 
                transform: translateY(-100px) translateX(20px) rotate(360deg) scale(0.2); 
                opacity: 0; 
            }
        }

        /* ÈïúÂ§¥ÊãâËøëÊïàÊûú */
        .camera-zoom {
            animation: cameraZoom 3s ease-out forwards;
        }

        @keyframes cameraZoom {
            0% { 
                transform: scale(0.1) rotateX(90deg); 
                opacity: 0; 
            }
            30% { 
                transform: scale(0.5) rotateX(60deg); 
                opacity: 0.5; 
            }
            100% { 
                transform: scale(1) rotateX(0deg); 
                opacity: 1; 
            }
        }

        /* Â±èÂπïÈúáÂä®ÊïàÊûú */
        @keyframes screenShake {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            10% { transform: translate(-2px, -1px) rotate(-0.5deg); }
            20% { transform: translate(-1px, 0px) rotate(0.5deg); }
            30% { transform: translate(2px, 1px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(0.5deg); }
            50% { transform: translate(-1px, 1px) rotate(-0.5deg); }
            60% { transform: translate(-2px, 0px) rotate(0deg); }
            70% { transform: translate(2px, 1px) rotate(-0.5deg); }
            80% { transform: translate(-1px, -1px) rotate(0.5deg); }
            90% { transform: translate(1px, 0px) rotate(0deg); }
        }

        /* ÂÖ®Â±èÈó™ÂÖâÊïàÊûú */
        @keyframes screenFlash {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Êõ¥Âçé‰∏ΩÁöÑÁ≤íÂ≠êÊïàÊûú */
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #fff;
            border-radius: 50%;
            pointer-events: none;
            animation: particleFloat 4s linear infinite;
            box-shadow: 0 0 10px currentColor;
        }

        @keyframes particleFloat {
            0% { 
                transform: translateY(100vh) rotate(0deg) scale(0); 
                opacity: 0; 
            }
            10% { 
                opacity: 1; 
                transform: translateY(90vh) rotate(36deg) scale(1);
            }
            90% { 
                opacity: 1; 
                transform: translateY(-10vh) rotate(324deg) scale(1);
            }
            100% { 
                transform: translateY(-20vh) rotate(360deg) scale(0); 
                opacity: 0; 
            }
        }
    </style>
</head>
<body>
    <!-- Âä†ËΩΩÂ±èÂπï -->
    <div id="loading-screen" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        height: calc(var(--vh, 1vh) * 100);
        background: linear-gradient(135deg, #0a1428 0%, #1e3c72 50%, #2a5298 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        color: white;
        text-align: center;
    ">
        <div style="font-size: 48px; margin-bottom: 20px; animation: rotate 2s infinite linear;">‚öΩ</div>
        <h2 style="margin-bottom: 10px;">PES Mobile ÊäΩÂç°Ê®°ÊãüÂô®</h2>
        <p style="margin-bottom: 20px; opacity: 0.8;">Ê≠£Âú®Âä†ËΩΩÁêÉÂëòÊï∞ÊçÆ...</p>
        <div style="
            width: 200px;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            overflow: hidden;
        ">
            <div style="
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, #00d4ff, #0099cc);
                transform: translateX(-100%);
                animation: loading 2s infinite;
            "></div>
        </div>
    </div>

    <!-- Ê®™Â±èÊèêÁ§∫ -->
    <div class="orientation-notice">
        <div class="rotate-icon">üîÑ</div>
        <h2>ËØ∑Â∞ÜËÆæÂ§áÊ®™ÂêëÊîæÁΩÆ</h2>
        <p>‰∏∫‰∫ÜËé∑ÂæóÊúÄ‰Ω≥Ê∏∏Êàè‰ΩìÈ™åÔºåËØ∑ÊóãËΩ¨ÊÇ®ÁöÑËÆæÂ§áÂà∞Ê®™Â±èÊ®°Âºè</p>
        <p style="margin-top: 10px; font-size: 14px; opacity: 0.8;">Rotate your device to landscape mode</p>
    </div>

    <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
    <div class="top-bar">
        <div class="logo">‚öΩ PES Mobile</div>
        <div class="currency-display">
            <div class="currency-item">
                <div class="coin-icon">üí∞</div>
                <span id="coins">99999</span>
            </div>
            <div class="currency-item">
                <div class="coin-icon">üíé</div>
                <span id="gems">500</span>
            </div>
            <div class="currency-item">
                <div class="coin-icon" style="background: linear-gradient(45deg, #ff1744, #c62828);">üî•</div>
                <span id="highlight-directed-tickets">2</span>
                <small>È´òÂÖâÂÆöÂêë</small>
            </div>
            <div class="currency-item">
                <div class="coin-icon" style="background: linear-gradient(45deg, #ffc107, #ff8f00);">‚≠ê</div>
                <span id="featured-directed-tickets">5</span>
                <small>Á≤æÈÄâÂÆöÂêë</small>
            </div>
            <div class="currency-item">
                <div class="coin-icon" style="background: linear-gradient(45deg, #ff6b6b, #ee5a52);">üé´</div>
                <span id="highlight-tickets">10</span>
                <small>È´òÂÖâÂç∑</small>
            </div>
            <div class="currency-item">
                <div class="coin-icon" style="background: linear-gradient(45deg, #ffd700, #ffb300);">üé´</div>
                <span id="featured-tickets">50</span>
                <small>Á≤æÈÄâÂç∑</small>
            </div>
            <div class="currency-item">
                <button class="gacha-btn" onclick="showRechargeModal()" style="padding: 8px 15px; font-size: 14px; background: linear-gradient(45deg, #4facfe, #00f2fe);">
                    üí≥ ÂÖÖÂÄº
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- ‰∏ªÊ†áÈ¢òÂå∫Âüü -->
        <div class="hero-section">
            <h1 class="hero-title">ÂÆûÂÜµË∂≥ÁêÉÊâãÊú∫Áâà</h1>
            <p class="hero-subtitle">‰ΩìÈ™åÁúüÂÆûÁöÑÁêÉÂëòÊäΩÂç°Á≥ªÁªü</p>
        </div>

        <!-- ÊäΩÂç°ÊåâÈíÆ -->
        <div class="gacha-buttons">
            <div class="pool-section">
                <h3>È´òÂÖâÂÆöÂêëÂç∑Ê±† (1%È´òÂÖâÊ¶ÇÁéá)</h3>
                <div class="pool-buttons">
                    <button class="gacha-btn highlight-pool" onclick="highlightDirectGacha(1)">
                        1ÊäΩ (1Âº†ÂÆöÂêëÂç∑)
                    </button>
                    <button class="gacha-btn highlight-pool" onclick="highlightDirectGacha(10)">
                        10ËøûÊäΩ (10Âº†ÂÆöÂêëÂç∑)
                    </button>
                    <button class="gacha-btn highlight-pool" onclick="highlightDirectGacha(20)">
                        20ËøûÊäΩ (20Âº†ÂÆöÂêëÂç∑)
                    </button>
                </div>
            </div>

            <div class="pool-section">
                <h3>Á≤æÈÄâÂÆöÂêëÂç∑Ê±† (1%Á≤æÈÄâÊ¶ÇÁéá)</h3>
                <div class="pool-buttons">
                    <button class="gacha-btn featured-pool" onclick="featuredDirectGacha(1)">
                        1ÊäΩ (1Âº†ÂÆöÂêëÂç∑)
                    </button>
                    <button class="gacha-btn featured-pool" onclick="featuredDirectGacha(10)">
                        10ËøûÊäΩ (10Âº†ÂÆöÂêëÂç∑)
                    </button>
                    <button class="gacha-btn featured-pool" onclick="featuredDirectGacha(20)">
                        20ËøûÊäΩ (20Âº†ÂÆöÂêëÂç∑)
                    </button>
                </div>
            </div>

            <div class="pool-section">
                <h3>È´òÂÖâÂç∑Ê±† (10%Ê¶ÇÁéá)</h3>
                <div class="pool-buttons">
                    <button class="gacha-btn highlight-normal" onclick="highlightGacha(1)">
                        1ÊäΩ (1Âº†È´òÂÖâÂç∑)
                    </button>
                    <button class="gacha-btn highlight-normal" onclick="highlightGacha(10)">
                        10ËøûÊäΩ (10Âº†È´òÂÖâÂç∑)
                    </button>
                    <button class="gacha-btn highlight-normal" onclick="highlightGacha(20)">
                        20ËøûÊäΩ (20Âº†È´òÂÖâÂç∑)
                    </button>
                </div>
            </div>

            <div class="pool-section">
                <h3>Á≤æÈÄâÂç∑Ê±† (4%Ê¶ÇÁéáÔºå250Âº†‰øùÂ∫ï10-12‰∏™Á≤æÈÄâ)</h3>
                <div class="pool-buttons">
                    <button class="gacha-btn featured-normal" onclick="featuredGacha(4)">
                        4ÊäΩ (1Âº†Á≤æÈÄâÂç∑)
                    </button>
                    <button class="gacha-btn featured-normal" onclick="featuredGacha(10)">
                        10ËøûÊäΩ (3Âº†Á≤æÈÄâÂç∑)
                    </button>
                    <button class="gacha-btn featured-normal" onclick="featuredGacha(20)">
                        20ËøûÊäΩ (5Âº†Á≤æÈÄâÂç∑)
                    </button>
                </div>
                <div class="pity-counter">
                    Á≤æÈÄâÂç∑Â∑≤‰ΩøÁî®: <span id="featured-counter">0</span>/250 
                    (‰øùÂ∫ïËøòÈúÄ: <span id="featured-remaining">250</span>Âº†)
                </div>
            </div>
        </div>

        <!-- Â∫ìÂ≠òÁÆ°ÁêÜÊåâÈíÆ -->
        <div class="gacha-buttons">
            <button class="gacha-btn inventory-btn" onclick="showInventory()">
                Êü•ÁúãÁêÉÂëòÂ∫ìÂ≠ò (ÂÖ±<span id="inventory-count">0</span>ÂêçÁêÉÂëò)
            </button>
            <button class="gacha-btn release-btn" onclick="showReleaseMode()">
                ÁêÉÂëòËß£Á∫¶Ê®°Âºè
            </button>
        </div>

        <!-- ÁªìÊûúÊòæÁ§∫Âå∫Âüü -->
        <div class="result-area">
            <h2 class="result-title">ÊäΩÂç°ÁªìÊûú</h2>
            <div class="cards-container" id="result-container">
                <p style="text-align: center; opacity: 0.7;">ÁÇπÂáª‰∏äÊñπÊåâÈíÆÂºÄÂßãÊäΩÂç°</p>
            </div>
        </div>
    </div>

    <!-- ËÉåÊôØÈü≥‰πê -->
    <audio id="bgm-audio" loop preload="auto" style="display: none;"></audio>
    <audio id="gacha-cheer-audio" preload="auto" style="display: none;">
        <source src="ÈºìÊéåÊ¨¢ÂëºÂ£∞Èü≥Êïà.mp3" type="audio/mpeg">
    </audio>

    <!-- ÊäΩÂç°Âä®ÁîªË¶ÜÁõñÂ±Ç -->
    <div class="gacha-animation-overlay" id="gacha-animation">
        <div class="stadium-container">
            <div class="stadium camera-zoom">
                <div class="stadium-field">
                    <div class="field-lines">
                        <div class="center-circle"></div>
                        <div class="penalty-area left"></div>
                        <div class="penalty-area right"></div>
                    </div>
                </div>
                <div class="stadium-lights" id="stadium-lights"></div>
                <div class="stadium-led" id="stadium-led"></div>
            </div>
        </div>
        <div class="fireworks-container" id="fireworks"></div>
        <div class="laser-container" id="laser-container"></div>
        <div class="energy-container" id="energy-container"></div>
        <div class="result-showcase" id="result-showcase"></div>
        
        <!-- Âä®ÁîªËøõÂ∫¶Êù° -->
        <div class="animation-progress-container">
            <div class="animation-progress-bar" id="animation-progress-bar"></div>
            <div class="animation-progress-glow" id="animation-progress-glow"></div>
        </div>
        
        <button class="skip-button" id="skip-button" onclick="skipGachaAnimation()">
            ‚ö° Ë∑≥ËøáÂä®Áîª
        </button>
    </div>

    <!-- ÂÖÖÂÄºÁïåÈù¢Ê®°ÊÄÅÊ°Ü -->
    <div class="recharge-modal" id="recharge-modal">
        <div class="recharge-content">
            <button class="close-btn" onclick="hideRechargeModal()">√ó</button>
            
            <div class="recharge-header">
                <div class="recharge-title">üí≥ ÁêÉÂëòÂç∑ÂÖÖÂÄº</div>
                <div class="recharge-subtitle">ÈÄâÊã©‰Ω†ÈúÄË¶ÅÁöÑÁêÉÂëòÂç∑Á±ªÂûã</div>
            </div>

            <div class="recharge-options">
                <!-- È´òÂÖâÂÆöÂêëÂç∑ -->
                <div class="recharge-option highlight-directed">
                    <div class="recharge-icon">üî•</div>
                    <div class="recharge-name">È´òÂÖâÂÆöÂêëÂç∑</div>
                    <div class="recharge-price">üíé 1000</div>
                    <div class="recharge-quantity">Ëé∑Âæó 10 Âº†</div>
                    <button class="purchase-btn" onclick="purchaseTickets('highlight-directed')">Á´ãÂç≥Ë¥≠‰π∞</button>
                </div>

                <!-- Á≤æÈÄâÂÆöÂêëÂç∑ -->
                <div class="recharge-option featured-directed">
                    <div class="recharge-icon">‚≠ê</div>
                    <div class="recharge-name">Á≤æÈÄâÂÆöÂêëÂç∑</div>
                    <div class="recharge-price">üíé 1000</div>
                    <div class="recharge-quantity">Ëé∑Âæó 10 Âº†</div>
                    <button class="purchase-btn" onclick="purchaseTickets('featured-directed')">Á´ãÂç≥Ë¥≠‰π∞</button>
                </div>

                <!-- È´òÂÖâÂç∑ -->
                <div class="recharge-option highlight-normal">
                    <div class="recharge-icon">üé´</div>
                    <div class="recharge-name">È´òÂÖâÂç∑</div>
                    <div class="recharge-price">üíé 50000</div>
                    <div class="recharge-quantity">Ëé∑Âæó 10 Âº†</div>
                    <button class="purchase-btn" onclick="purchaseTickets('highlight-normal')">Á´ãÂç≥Ë¥≠‰π∞</button>
                </div>

                <!-- Á≤æÈÄâÂç∑ -->
                <div class="recharge-option featured-normal">
                    <div class="recharge-icon">üéüÔ∏è</div>
                    <div class="recharge-name">Á≤æÈÄâÂç∑</div>
                    <div class="recharge-price">üíé 50000</div>
                    <div class="recharge-quantity">Ëé∑Âæó 10 Âº†</div>
                    <button class="purchase-btn" onclick="purchaseTickets('featured-normal')">Á´ãÂç≥Ë¥≠‰π∞</button>
                </div>
            </div>

            <div style="text-align: center; color: rgba(255, 255, 255, 0.7); font-size: 14px;">
                ‚ö†Ô∏è ËØ∑Ê†πÊçÆÈúÄË¶ÅÂêàÁêÜÂÖÖÂÄºÔºåÁêÜÊÄßÊ∂àË¥π
            </div>
        </div>
    </div>

    <script src="card-system.js"></script>
    <script>
        // ÁßªÂä®Á´ØÂÖ®Â±èÂíåÊ®™Â±èÁÆ°ÁêÜ
        class MobileFullscreenManager {
            constructor() {
                this.init();
            }

            init() {
                // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÁ´ãÂç≥Â∞ùËØïÂÖ®Â±è
                document.addEventListener('DOMContentLoaded', () => {
                    this.handleMobileOptimization();
                });

                // ÁõëÂê¨Â±èÂπïÊñπÂêëÂèòÂåñ
                window.addEventListener('orientationchange', () => {
                    setTimeout(() => this.handleOrientationChange(), 500);
                });

                // ÁõëÂê¨Á™óÂè£Â§ßÂ∞èÂèòÂåñ
                window.addEventListener('resize', () => {
                    this.handleOrientationChange();
                });

                // Ëß¶Êë∏ÂºÄÂßãÊó∂Â∞ùËØïÂÖ®Â±è
                document.addEventListener('touchstart', this.tryEnterFullscreen.bind(this), { once: true });
                
                // ÁÇπÂáªÂºÄÂßãÊó∂Â∞ùËØïÂÖ®Â±è
                document.addEventListener('click', this.tryEnterFullscreen.bind(this), { once: true });
            }

            handleMobileOptimization() {
                // Ê£ÄÊµãÁßªÂä®ËÆæÂ§á
                if (this.isMobile()) {
                    // ÈöêËóèÂú∞ÂùÄÊ†è
                    this.hideAddressBar();
                    
                    // ËÆæÁΩÆviewportÈ´òÂ∫¶
                    this.setViewportHeight();
                    
                    // Â§ÑÁêÜÂ±èÂπïÊñπÂêë
                    this.handleOrientationChange();
                    
                    // ÈòªÊ≠¢ÈªòËÆ§ÊªöÂä®Ë°å‰∏∫
                    this.preventScrolling();
                }
            }

            isMobile() {
                return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            }

            hideAddressBar() {
                // ÊªöÂä®Âà∞È°∂ÈÉ®ÈöêËóèÂú∞ÂùÄÊ†è
                window.scrollTo(0, 1);
                setTimeout(() => window.scrollTo(0, 0), 100);
            }

            setViewportHeight() {
                // ËÆæÁΩÆCSSËá™ÂÆö‰πâÂ±ûÊÄß‰∏∫ÂÆûÈôÖËßÜÂè£È´òÂ∫¶
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            }

            handleOrientationChange() {
                setTimeout(() => {
                    this.setViewportHeight();
                    
                    // Âè™Âú®ÁßªÂä®ËÆæÂ§á‰∏äÂ§ÑÁêÜÊ®™Â±èÊèêÁ§∫
                    if (this.isMobile()) {
                        // Ê£ÄÊü•ÊòØÂê¶‰∏∫Ê®™Â±è
                        const isLandscape = window.innerWidth > window.innerHeight;
                        const orientationNotice = document.querySelector('.orientation-notice');
                        
                        if (orientationNotice) {
                            orientationNotice.style.display = isLandscape ? 'none' : 'flex';
                        }
                        
                        // Ê®™Â±èÊó∂ÈöêËóèÂú∞ÂùÄÊ†è
                        if (isLandscape) {
                            this.hideAddressBar();
                        }
                    }
                }, 100);
            }

            tryEnterFullscreen() {
                if (this.isMobile()) {
                    const element = document.documentElement;
                    
                    // Â∞ùËØïËøõÂÖ•ÂÖ®Â±è
                    if (element.requestFullscreen) {
                        element.requestFullscreen().catch(e => console.log('ÂÖ®Â±èÂ§±Ë¥•:', e));
                    } else if (element.webkitRequestFullscreen) {
                        element.webkitRequestFullscreen().catch(e => console.log('ÂÖ®Â±èÂ§±Ë¥•:', e));
                    } else if (element.mozRequestFullScreen) {
                        element.mozRequestFullScreen().catch(e => console.log('ÂÖ®Â±èÂ§±Ë¥•:', e));
                    } else if (element.msRequestFullscreen) {
                        element.msRequestFullscreen().catch(e => console.log('ÂÖ®Â±èÂ§±Ë¥•:', e));
                    }
                    
                    this.hideAddressBar();
                }
            }

            preventScrolling() {
                // ÈòªÊ≠¢È°µÈù¢ÊªöÂä®
                document.addEventListener('touchmove', function(e) {
                    e.preventDefault();
                }, { passive: false });
                
                // ÈòªÊ≠¢ÂèåÂáªÁº©Êîæ
                let lastTouchEnd = 0;
                document.addEventListener('touchend', function(event) {
                    const now = (new Date()).getTime();
                    if (now - lastTouchEnd <= 300) {
                        event.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }
        }

        // ÂàùÂßãÂåñÁßªÂä®Á´ØÁÆ°ÁêÜÂô®
        const mobileManager = new MobileFullscreenManager();

        // Ëß¶Êë∏ÊâãÂäøÂ¢ûÂº∫
        class TouchEnhancer {
            constructor() {
                this.initTouchFeedback();
            }

            initTouchFeedback() {
                // ‰∏∫ÊâÄÊúâÊåâÈíÆÊ∑ªÂä†Ëß¶Êë∏ÂèçÈ¶à
                document.addEventListener('touchstart', (e) => {
                    const target = e.target.closest('button, .pool-card, .gacha-button');
                    if (target) {
                        target.style.transform = 'scale(0.98)';
                        target.style.opacity = '0.9';
                    }
                });

                document.addEventListener('touchend', (e) => {
                    const target = e.target.closest('button, .pool-card, .gacha-button');
                    if (target) {
                        setTimeout(() => {
                            target.style.transform = '';
                            target.style.opacity = '';
                        }, 150);
                    }
                });

                // ÈïøÊåâÊåØÂä®ÂèçÈ¶àÔºàÂ¶ÇÊûúÊîØÊåÅÔºâ
                document.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    if ('vibrate' in navigator) {
                        navigator.vibrate(50);
                    }
                });
            }
        }

        // ÂàùÂßãÂåñËß¶Êë∏Â¢ûÂº∫
        const touchEnhancer = new TouchEnhancer();

        // ‰ªéÂ§ñÈÉ®Êñá‰ª∂Âä†ËΩΩÁêÉÂëòÊï∞ÊçÆ
        let playersData = [];
        let gachaSystem = {};
        
        // Âä†ËΩΩÁêÉÂëòÊï∞ÊçÆ
        fetch('players_data_complete.json')
            .then(response => response.json())
            .then(data => {
                playersData = data.ÁêÉÂëò;
                gachaSystem = data;
                console.log('ÁêÉÂëòÊï∞ÊçÆÂä†ËΩΩÂÆåÊàê:', playersData.length, 'ÂêçÁêÉÂëò');
                console.log('Âç°Ê±†Á≥ªÁªüÂä†ËΩΩÂÆåÊàê');
                
                // ÈöêËóèÂä†ËΩΩÂ±èÂπï
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    if (loadingScreen) {
                        loadingScreen.style.opacity = '0';
                        loadingScreen.style.transition = 'opacity 0.5s ease';
                        setTimeout(() => {
                            loadingScreen.style.display = 'none';
                        }, 500);
                    }
                }, 1000);
            })
            .catch(error => {
                console.error('Âä†ËΩΩÁêÉÂëòÊï∞ÊçÆÂ§±Ë¥•:', error);
                // ‰ΩøÁî®Â§áÁî®Êï∞ÊçÆ
                playersData = [
                    {
                        "ÂßìÂêç": "Ê¢ÖË•ø",
                        "Á®ÄÊúâÂ∫¶": "‰º†Â•áÈ´òÂÖâ",
                        "ÊÄªËØÑ": 98,
                        "‰ΩçÁΩÆ": "RWF",
                        "ÂõΩÁ±ç": "ÈòøÊ†πÂª∑",
                        "‰ø±‰πêÈÉ®": "ËøàÈòøÂØÜÂõΩÈôÖ",
                        "Âπ¥ÈæÑ": 36,
                        "Ë∫´È´ò": 170,
                        "‰ΩìÈáç": 72,
                        "ÊÉØÁî®ËÑö": "Â∑¶ËÑö",
                        "ËÉΩÂäõÂÄº": {
                            "ËøõÊîª": 98,
                            "Èò≤ÂÆà": 38,
                            "Ë∫´‰Ωì": 78,
                            "ÈÄüÂ∫¶": 85,
                            "‰º†ÁêÉ": 95,
                            "ËøêÁêÉ": 99
                        },
                        "ÁâπÊÆäÊäÄËÉΩ": ["ËΩªËß¶Â∞ÑÈó®", "‰ΩéÁ©∫‰º†ÁêÉ", "ÂçïËß¶‰º†ÁêÉ", "È©¨ËµõÂõûËΩ¨"],
                        "ÊàòÊúØÈ£éÊ†º": "ÂàõÈÄ†ÂûãÂâçËÖ∞",
                        "ÁêÉÂëòÁ±ªÂûã": "ÂàõÈÄ†Âûã",
                        "ÊòüÁ∫ß": 5
                    }
                ];
            });

        // Ë¥ßÂ∏ÅÁ≥ªÁªü - Êñ∞Â¢ûÂêÑÁßçÂç∑
        let playerCurrency = {
            coins: 99999,
            gems: 500000,
            È´òÂÖâÂÆöÂêëÂç∑: 100,
            Á≤æÈÄâÂÆöÂêëÂç∑: 500,
            È´òÂÖâÂç∑: 50,
            Á≤æÈÄâÂç∑: 150
        };

        // Áî®Êà∑ÁêÉÂëòÂ∫ìÂ≠ò
        let playerInventory = [];
        
        // Á≤æÈÄâÂç∑‰øùÂ∫ïËÆ°Êï∞Âô®
        let featuredGachaCounter = 0;
        let guaranteedFeaturedCount = 0;

        // ËÉåÊôØÈü≥‰πêÁ≥ªÁªü
        const bgmAudio = document.getElementById('bgm-audio');
        let currentBGMIndex = -1;
        let bgmFadeInterval = null;
        
        // Èü≥‰πêÊõ≤Â∫ì - ‰ΩøÁî®Êú¨Âú∞bgmÊñá‰ª∂Â§πÁöÑÈü≥‰πêÊñá‰ª∂
        const bgmPlaylist = [
            'bgm/0.flac.mp3',
            'bgm/1.flac.mp3',
            'bgm/2.flac.mp3',
            'bgm/3.flac.mp3',
            'bgm/4.flac.mp3',
            'bgm/5.flac.mp3',
            'bgm/6.flac.mp3',
            'bgm/7.flac.mp3',
            'bgm/8.flac.mp3',
            'bgm/9.flac.mp3',
            'bgm/10.flac.mp3',
            'bgm/11.flac.mp3',
            'bgm/12.flac.mp3',
            'bgm/13.flac.mp3',
            'bgm/14.flac.mp3',
            'bgm/15.flac.mp3',
            'bgm/16.flac.mp3',
            'bgm/17.flac.mp3',
            'bgm/18.flac.mp3',
            'bgm/19.flac.mp3',
            'bgm/20.flac.mp3',
            'bgm/21.flac.mp3',
            'bgm/22.flac.mp3',
            'bgm/23.flac.mp3'
        ];

        // Á®ÄÊúâÂ∫¶Ê¶ÇÁéá - Êõ¥Êñ∞‰∏∫ÁúüÂÆûÊ¶ÇÁéá
        const rarityRates = {
            'ÊôÆÂç°': 1,         // 99% - 2-3Êòü
            'Ê¢¶ÂπªÁ≤æÈÄâ': 0,     // 0.5% - 4Êòü
            'Á≤æÈÄâ': 0,         // 0.4% - 4ÊòüÈ´ò (Á≤æÈÄâÂç∑Âü∫Á°ÄÊ¶ÇÁéá)
            'È´òÂÖâ': 0,        // 0.09% - 5Êòü (È´òÂÖâÂç∑Âü∫Á°ÄÊ¶ÇÁéá)
            '‰º†Â•áÈ´òÂÖâ': 0     // 0.01% - 5ÊòüÈ°∂Á∫ß
        };

        // Á®ÄÊúâÂ∫¶‰∏≠ÊñáÂêçÂíåÊ†∑Âºè
        const rarityConfig = {
            'ÊôÆÂç°': { name: 'ÊôÆÂç°', class: 'normal-card' },
            'Ê¢¶ÂπªÁ≤æÈÄâ': { name: 'Ê¢¶ÂπªÁ≤æÈÄâ', class: 'dream-featured' },
            'Á≤æÈÄâ': { name: 'Á≤æÈÄâ', class: 'featured' },
            'È´òÂÖâ': { name: 'È´òÂÖâ', class: 'highlight' },
            '‰º†Â•áÈ´òÂÖâ': { name: '‰º†Â•áÈ´òÂÖâ', class: 'legend-highlight' }
        };

        // ÈöèÊú∫ÈÄâÊã©Á®ÄÊúâÂ∫¶
        function getRandomRarity() {
            const random = Math.random();
            let accumulated = 0;
            
            for (const [rarity, rate] of Object.entries(rarityRates)) {
                accumulated += rate;
                if (random <= accumulated) {
                    return rarity;
                }
            }
            return 'white-ball';
        }

        // Ê†πÊçÆÁ®ÄÊúâÂ∫¶Ëé∑ÂèñÁêÉÂëò
        function getPlayerByRarity(targetRarity) {
            const playersOfRarity = playersData.filter(player => player.Á®ÄÊúâÂ∫¶ === targetRarity);
            if (playersOfRarity.length > 0) {
                return playersOfRarity[Math.floor(Math.random() * playersOfRarity.length)];
            }
            // Â¶ÇÊûúÊ≤°ÊúâËØ•Á®ÄÊúâÂ∫¶ÁöÑÁêÉÂëòÔºåËøîÂõûÊôÆÂç°ÁêÉÂëò
            const normalPlayers = playersData.filter(player => player.Á®ÄÊúâÂ∫¶ === 'ÊôÆÂç°');
            return normalPlayers[Math.floor(Math.random() * normalPlayers.length)] || playersData[0];
        }

        // ÂàõÂª∫ÁêÉÂëòÂç°ÁâáHTML
        function createPlayerCard(player, showButtons = false) {
            const rarityConfig = {
                'ÊôÆÂç°': 'normal-card',
                'Ê¢¶ÂπªÁ≤æÈÄâ': 'dream-featured',
                'Á≤æÈÄâ': 'featured',
                'È´òÂÖâ': 'highlight',
                '‰º†Â•áÈ´òÂÖâ': 'legend-highlight'
            };

            const sparkles = Array.from({length: 5}, (_, i) => 
                `<div class="sparkle" style="top: ${Math.random() * 100}%; left: ${Math.random() * 100}%; animation-delay: ${i * 0.3}s;"></div>`
            ).join('');

            const buttonsHtml = showButtons ? `
                <div class="card-buttons">
                    <button class="release-btn" onclick="releasePlayer('${player.ÂßìÂêç}')">
                        Ëß£Á∫¶ (Ëé∑Âæó ${getReleaseReward(player)})
                    </button>
                </div>
            ` : '';

            return `
                <div class="player-card" onclick="flipCard(this)">
                    <div class="card-inner">
                        <div class="card-front ${rarityConfig[player.Á®ÄÊúâÂ∫¶] || 'normal-card'}">
                            ${sparkles}
                            <div class="card-header">
                                <div class="rarity-badge">${player.Á®ÄÊúâÂ∫¶}</div>
                                <div class="player-name">${player.ÂßìÂêç}</div>
                                <div class="player-overall">${player.ÊÄªËØÑ}</div>
                            </div>
                            <div class="card-body">
                                <div class="player-info">
                                    <div class="player-position">${player.‰ΩçÁΩÆ}</div>
                                    <div class="player-club">${player.‰ø±‰πêÈÉ®}</div>
                                    <div class="player-nationality">${player.ÂõΩÁ±ç}</div>
                                    <div class="star-rating">${'‚≠ê'.repeat(player.ÊòüÁ∫ß || 3)}</div>
                                </div>
                                ${!showButtons ? `<div class="click-hint-small">üëÜ ÁÇπÂáªÊü•ÁúãËØ¶ÊÉÖ</div>` : ''}
                            </div>
                            ${buttonsHtml}
                        </div>
                        <div class="card-back ${rarityConfig[player.Á®ÄÊúâÂ∫¶] || 'normal-card'}">
                            ${showButtons ? `
                            <div style="width: 100%;">
                                <h3 style="margin-bottom: 20px;">${player.ÂßìÂêç} ËØ¶ÁªÜÊï∞ÊçÆ</h3>
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <div class="stat-label">ËøõÊîª</div>
                                        <div class="stat-value">${player.ËÉΩÂäõÂÄº.ËøõÊîª}</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">Èò≤ÂÆà</div>
                                        <div class="stat-value">${player.ËÉΩÂäõÂÄº.Èò≤ÂÆà}</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">Ë∫´‰Ωì</div>
                                        <div class="stat-value">${player.ËÉΩÂäõÂÄº.Ë∫´‰Ωì}</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">ÈÄüÂ∫¶</div>
                                        <div class="stat-value">${player.ËÉΩÂäõÂÄº.ÈÄüÂ∫¶}</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">‰º†ÁêÉ</div>
                                        <div class="stat-value">${player.ËÉΩÂäõÂÄº.‰º†ÁêÉ}</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">ËøêÁêÉ</div>
                                        <div class="stat-value">${player.ËÉΩÂäõÂÄº.ËøêÁêÉ}</div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px; font-size: 14px;">
                                    <div><strong>Ë∫´È´ò:</strong> ${player.Ë∫´È´ò}cm</div>
                                    <div><strong>‰ΩìÈáç:</strong> ${player.‰ΩìÈáç}kg</div>
                                    <div><strong>ÊÉØÁî®ËÑö:</strong> ${player.ÊÉØÁî®ËÑö}</div>
                                    <div><strong>Á±ªÂûã:</strong> ${player.ÁêÉÂëòÁ±ªÂûã}</div>
                                </div>
                            </div>
                            ` : `
                            <div class="mystery-card-back">
                                <div class="mystery-content">
                                    <div class="pes-logo">‚öΩ</div>
                                    <h3>PES Mobile</h3>
                                    <p>ÁêÉÂëòÂç°Áâá</p>
                                    <div class="click-hint">
                                        <div class="click-icon">üëÜ</div>
                                        <p>ÁÇπÂáªÁøªÂç°</p>
                                    </div>
                                </div>
                                ${sparkles}
                            </div>
                            `}
                        </div>
                    </div>
                </div>
            `;
        }

        // Ëé∑ÂèñËß£Á∫¶Â•ñÂä±
        function getReleaseReward(player) {
            if (player.Á®ÄÊúâÂ∫¶ === 'È´òÂÖâ' || player.Á®ÄÊúâÂ∫¶ === '‰º†Â•áÈ´òÂÖâ') {
                return '2Âº†È´òÂÖâÂç∑';
            } else if (player.Á®ÄÊúâÂ∫¶ === 'Á≤æÈÄâ') {
                const rating = player.ÊÄªËØÑ;
                if (rating >= 98) return '6Âº†Á≤æÈÄâÂç∑';
                if (rating >= 97) return '5Âº†Á≤æÈÄâÂç∑';
                if (rating >= 96) return '4Âº†Á≤æÈÄâÂç∑';
                if (rating >= 95) return '3Âº†Á≤æÈÄâÂç∑';
                if (rating >= 94) return '2Âº†Á≤æÈÄâÂç∑';
                return '1Âº†Á≤æÈÄâÂç∑';
            } else if (player.Á®ÄÊúâÂ∫¶ === 'Ê¢¶ÂπªÁ≤æÈÄâ') {
                return '1Âº†Á≤æÈÄâÂç∑';
            }
            return 'Êó†Â•ñÂä±';
        }

        // È´òÂÖâÂÆöÂêëÂç∑Ê±† (1%È´òÂÖâÊ¶ÇÁéá)
        function highlightDirectGacha(times) {
            const cost = getCost(times, 'other');
            if (playerCurrency.È´òÂÖâÂÆöÂêëÂç∑ < cost) {
                alert(`È´òÂÖâÂÆöÂêëÂç∑‰∏çË∂≥ÔºÅÈúÄË¶Å${cost}Âº†`);
                return;
            }

            playerCurrency.È´òÂÖâÂÆöÂêëÂç∑ -= cost;
            startGachaAnimation(times, 'È´òÂÖâÂÆöÂêëÂç∑Ê±†');
        }

        // Á≤æÈÄâÂÆöÂêëÂç∑Ê±† (1%Á≤æÈÄâÊ¶ÇÁéá)
        function featuredDirectGacha(times) {
            const cost = getCost(times, 'other');
            if (playerCurrency.Á≤æÈÄâÂÆöÂêëÂç∑ < cost) {
                alert(`Á≤æÈÄâÂÆöÂêëÂç∑‰∏çË∂≥ÔºÅÈúÄË¶Å${cost}Âº†`);
                return;
            }

            playerCurrency.Á≤æÈÄâÂÆöÂêëÂç∑ -= cost;
            startGachaAnimation(times, 'Á≤æÈÄâÂÆöÂêëÂç∑Ê±†');
        }

        // È´òÂÖâÂç∑Ê±† (10%È´òÂÖâÊ¶ÇÁéá)
        function highlightGacha(times) {
            const cost = getCost(times, 'other');
            if (playerCurrency.È´òÂÖâÂç∑ < cost) {
                alert(`È´òÂÖâÂç∑‰∏çË∂≥ÔºÅÈúÄË¶Å${cost}Âº†`);
                return;
            }

            playerCurrency.È´òÂÖâÂç∑ -= cost;
            startGachaAnimation(times, 'È´òÂÖâÂç∑Ê±†');
        }

        // Á≤æÈÄâÂç∑Ê±† (4%Á≤æÈÄâÔºå250Âº†‰øùÂ∫ï10-12‰∏™)
        function featuredGacha(times) {
            const cost = getCost(times, 'featured');
            if (playerCurrency.Á≤æÈÄâÂç∑ < cost) {
                alert(`Á≤æÈÄâÂç∑‰∏çË∂≥ÔºÅÈúÄË¶Å${cost}Âº†`);
                return;
            }

            playerCurrency.Á≤æÈÄâÂç∑ -= cost;
            featuredGachaCounter += cost;
            
            // Ê£ÄÊü•‰øùÂ∫ï
            if (featuredGachaCounter >= 250) {
                startGachaAnimationWithPity(times);
                return;
            }
            
            startGachaAnimation(times, 'Á≤æÈÄâÂç∑Ê±†');
        }

        // Ëé∑ÂèñÊäΩÂç°Ê∂àËÄó - ‰∏çÂêåÂç∑Á±ªÂûã‰∏çÂêåËÆ°Ë¥π
        function getCost(times, poolType = 'featured') {
            if (poolType === 'featured') {
                // Á≤æÈÄâÂç∑: 1Âº†ÊäΩ4‰∏™Ôºå4ÊäΩ/10Ëøû/20ËøûÊåâÊØî‰æã
                switch(times) {
                    case 4: return 1;   // 4ÊäΩ = 1Âº†Âç∑
                    case 10: return 3;  // 10ËøûÊäΩ = 3Âº†Âç∑  
                    case 20: return 5;  // 20ËøûÊäΩ = 5Âº†Âç∑
                    default: return 1;
                }
            } else {
                // ÂÖ∂‰ªñÂç∑: 1Âº†1ÊäΩÔºå10Âº†10ÊäΩÔºå20Âº†20ÊäΩ
                switch(times) {
                    case 1: return 1;   // 1ÊäΩ = 1Âº†Âç∑
                    case 4: return 4;   // 4ÊäΩ = 4Âº†Âç∑
                    case 10: return 10; // 10ËøûÊäΩ = 10Âº†Âç∑  
                    case 20: return 20; // 20ËøûÊäΩ = 20Âº†Âç∑
                    default: return times;
                }
            }
        }

        // Â§ÑÁêÜÁ≤æÈÄâÂç∑‰øùÂ∫ï
        function handleFeaturedPity(times) {
            const guaranteedCount = 10 + Math.floor(Math.random() * 3); // 10-12‰∏™ÈöèÊú∫
            const results = [];
            
            // ‰øùÂ∫ïÁ≤æÈÄâÁêÉÂëò
            for (let i = 0; i < guaranteedCount; i++) {
                const player = getPlayerByRarity('Á≤æÈÄâ');
                if (player) {
                    const isNew = !playerInventory.some(p => p.ÂßìÂêç === player.ÂßìÂêç);
                    if (isNew) {
                        playerInventory.push({...player, Ëé∑ÂæóÊó∂Èó¥: new Date().toISOString()});
                    }
                    results.push({player, isNew, isPity: true});
                }
            }
            
            // Ââ©‰ΩôÊôÆÈÄöÊäΩÂç°
            const remainingTimes = times - guaranteedCount;
            for (let i = 0; i < remainingTimes; i++) {
                const rarity = getRandomRarity();
                const player = getPlayerByRarity(rarity);
                if (player) {
                    const isNew = !playerInventory.some(p => p.ÂßìÂêç === player.ÂßìÂêç);
                    if (isNew) {
                        playerInventory.push({...player, Ëé∑ÂæóÊó∂Èó¥: new Date().toISOString()});
                    }
                    results.push({player, isNew});
                }
            }

            // ÈáçÁΩÆ‰øùÂ∫ïËÆ°Êï∞Âô®
            featuredGachaCounter = 0;
            guaranteedFeaturedCount += guaranteedCount;

            displayGachaResults(results, `Á≤æÈÄâÂç∑Ê±† - ‰øùÂ∫ïËß¶ÂèëÔºÅËé∑Âæó${guaranteedCount}‰∏™Á≤æÈÄâÁêÉÂëò`);
            updateCurrencyDisplay();
            updateInventoryCount();
            updatePityCounter();
        }

        // ÊâßË°åÊäΩÂç° - ‰øÆÊ≠£‰∏∫ÁúüÂÆûÁöÑ1%Ê¶ÇÁéá
        function performGacha(times, poolName) {
            const results = [];
            
            for (let i = 0; i < times; i++) {
                let targetRarity = null;
                
                if (poolName === 'È´òÂÖâÂÆöÂêëÂç∑Ê±†') {
                    // 1%È´òÂÖâÊ¶ÇÁéá (‰∏çÊòØ100%!)
                    const random = Math.random();
                    if (random < 0.001) {
                        targetRarity = '‰º†Â•áÈ´òÂÖâ';  // 0.1%‰º†Â•áÈ´òÂÖâ
                    } else if (random < 0.01) {
                        targetRarity = 'È´òÂÖâ';      // 0.9%ÊôÆÈÄöÈ´òÂÖâ
                    }
                    // 99%Ê¶ÇÁéáËµ∞Ê≠£Â∏∏ÊäΩÂç°
                } else if (poolName === 'Á≤æÈÄâÂÆöÂêëÂç∑Ê±†') {
                    // 1%Á≤æÈÄâÊ¶ÇÁéá (‰∏çÊòØ100%!)
                    if (Math.random() < 0.01) {
                        targetRarity = 'Á≤æÈÄâ';      // 1%Á≤æÈÄâ
                    }
                    // 99%Ê¶ÇÁéáËµ∞Ê≠£Â∏∏ÊäΩÂç°
                } else if (poolName === 'È´òÂÖâÂç∑Ê±†') {
                    // 10%È´òÂÖâÊ¶ÇÁéá
                    const random = Math.random();
                    if (random < 0.01) {
                        targetRarity = '‰º†Â•áÈ´òÂÖâ';  // 1%‰º†Â•áÈ´òÂÖâ
                    } else if (random < 0.10) {
                        targetRarity = 'È´òÂÖâ';      // 9%ÊôÆÈÄöÈ´òÂÖâ
                    }
                    // 90%Ê¶ÇÁéáËµ∞Ê≠£Â∏∏ÊäΩÂç°
                } else if (poolName === 'Á≤æÈÄâÂç∑Ê±†') {
                    // 4%Á≤æÈÄâÊ¶ÇÁéá
                    if (Math.random() < 0.04) {
                        targetRarity = 'Á≤æÈÄâ';      // 4%Á≤æÈÄâ
                    }
                    // 96%Ê¶ÇÁéáËµ∞Ê≠£Â∏∏ÊäΩÂç°
                }
                
                // Â¶ÇÊûúÊ≤°ÊúâËß¶ÂèëÁâπÊÆäÊ¶ÇÁéáÔºå‰ΩøÁî®ÊôÆÈÄöÊ¶ÇÁéá
                if (!targetRarity) {
                    targetRarity = getRandomRarity();
                }
                
                const player = getPlayerByRarity(targetRarity);
                if (player) {
                    // Ê£ÄÊü•ÊòØÂê¶Â∑≤Êã•ÊúâËØ•ÁêÉÂëò
                    const isNew = !playerInventory.some(p => p.ÂßìÂêç === player.ÂßìÂêç);
                    if (isNew) {
                        playerInventory.push({...player, Ëé∑ÂæóÊó∂Èó¥: new Date().toISOString()});
                    }
                    results.push({player, isNew});
                }
            }

            // ÊòæÁ§∫ÁªìÊûú
            displayGachaResults(results, poolName);
            updateCurrencyDisplay();
            updateInventoryCount();
            updatePityCounter();
        }

        // Êõ¥Êñ∞‰øùÂ∫ïËÆ°Êï∞Âô®ÊòæÁ§∫
        function updatePityCounter() {
            document.getElementById('featured-counter').textContent = featuredGachaCounter;
            document.getElementById('featured-remaining').textContent = Math.max(0, 250 - featuredGachaCounter);
        }

        // ÊòæÁ§∫ÊäΩÂç°ÁªìÊûú
        function displayGachaResults(results, poolName) {
            const resultContainer = document.getElementById('result-container');
            const title = document.querySelector('.result-title');
            
            title.innerHTML = `${poolName} - ÊäΩÂç°ÁªìÊûú (${results.length}Âº†Âç°Áâá) <small style="font-size: 14px; opacity: 0.7;">ÁÇπÂáªÂç°ÁâáÊü•ÁúãËØ¶ÊÉÖ</small>`;
            
            const cardsHtml = results.map(result => {
                const cardHtml = createPlayerCard(result.player);
                let badges = '';
                if (result.isNew) badges += '<div class="new-badge">NEW!</div>';
                if (result.isPity) badges += '<div class="pity-badge">‰øùÂ∫ï!</div>';
                return cardHtml.replace('</div>', badges + '</div>');
            }).join('');
            
            resultContainer.innerHTML = cardsHtml;

            // ÂàùÂßãÊòæÁ§∫‰∏∫ËÉåÈù¢ (ÁßªÈô§Ëá™Âä®ÁøªËΩ¨Âä®Áîª)
            const cards = resultContainer.querySelectorAll('.player-card .card-inner');
            cards.forEach((card) => {
                card.style.transform = 'rotateY(180deg)'; // ÂàùÂßãÊòæÁ§∫ËÉåÈù¢
            });
        }

        // ÁêÉÂëòËß£Á∫¶
        function releasePlayer(playerName) {
            const playerIndex = playerInventory.findIndex(p => p.ÂßìÂêç === playerName);
            if (playerIndex === -1) {
                alert('Êú™ÊâæÂà∞ËØ•ÁêÉÂëòÔºÅ');
                return;
            }

            const player = playerInventory[playerIndex];
            const reward = getReleaseReward(player);
            
            if (confirm(`Á°ÆÂÆöË¶ÅËß£Á∫¶ ${playerName} ÂêóÔºü\nËß£Á∫¶Â∞ÜËé∑ÂæóÔºö${reward}`)) {
                // ÁßªÈô§ÁêÉÂëò
                playerInventory.splice(playerIndex, 1);
                
                // Áªô‰∫àÂ•ñÂä±
                if (reward.includes('È´òÂÖâÂç∑')) {
                    const count = parseInt(reward.match(/\d+/)[0]);
                    playerCurrency.È´òÂÖâÂç∑ += count;
                } else if (reward.includes('Á≤æÈÄâÂç∑')) {
                    const count = parseInt(reward.match(/\d+/)[0]);
                    playerCurrency.Á≤æÈÄâÂç∑ += count;
                } else if (reward.includes('Ê¢¶ÂπªÁ≤æÈÄâÂç∑')) {
                    const count = parseInt(reward.match(/\d+/)[0]);
                    playerCurrency.Á≤æÈÄâÂç∑ += Math.floor(count / 2); // Ê¢¶ÂπªÁ≤æÈÄâËΩ¨Êç¢‰∏∫Á≤æÈÄâÂç∑
                }
                
                // Á´ãÂç≥‰øùÂ≠òÊï∞ÊçÆÂà∞localStorage
                localStorage.setItem('pesPlayerInventory', JSON.stringify(playerInventory));
                localStorage.setItem('pesCurrency', JSON.stringify(playerCurrency));
                
                updateCurrencyDisplay();
                updateInventoryCount();
                
                // Ê£ÄÊü•ÂΩìÂâçÈ°µÈù¢Áä∂ÊÄÅÂπ∂Âà∑Êñ∞ÊòæÁ§∫
                const currentTitle = document.querySelector('.result-title').textContent;
                if (currentTitle.includes('ÁêÉÂëòÂ∫ìÂ≠ò') || currentTitle.includes('Ëß£Á∫¶Ê®°Âºè')) {
                    // ÈáçÊñ∞ÊòæÁ§∫ÂΩìÂâçÈ°µÈù¢
                    if (currentTitle.includes('Â∫ìÂ≠ò')) {
                        showInventory();
                    } else if (currentTitle.includes('Ëß£Á∫¶Ê®°Âºè')) {
                        showReleaseMode();
                    }
                }
                
                alert(`${playerName} Â∑≤Ëß£Á∫¶ÔºÅËé∑Âæó ${reward}`);
            }
        }

        // ÊòæÁ§∫Â∫ìÂ≠ò
        function showInventory() {
            const resultContainer = document.getElementById('result-container');
            const title = document.querySelector('.result-title');
            
            title.textContent = `ÁêÉÂëòÂ∫ìÂ≠ò (${playerInventory.length}ÂêçÁêÉÂëò)`;
            
            if (playerInventory.length === 0) {
                resultContainer.innerHTML = '<p style="text-align: center; opacity: 0.7;">ÊöÇÊó†ÁêÉÂëòÔºåÂø´ÂéªÊäΩÂç°ÂêßÔºÅ</p>';
                return;
            }

            const cardsHtml = playerInventory.map(player => createPlayerCard(player, true)).join('');
            resultContainer.innerHTML = cardsHtml;
        }

        // ÊòæÁ§∫Ëß£Á∫¶Ê®°Âºè
        function showReleaseMode() {
            const resultContainer = document.getElementById('result-container');
            const title = document.querySelector('.result-title');
            
            title.textContent = 'ÁêÉÂëòËß£Á∫¶Ê®°Âºè - ÁÇπÂáªÁêÉÂëòÂç°ÁâáËøõË°åËß£Á∫¶';
            
            if (playerInventory.length === 0) {
                resultContainer.innerHTML = '<p style="text-align: center; opacity: 0.7;">ÊöÇÊó†ÁêÉÂëòÂèØËß£Á∫¶ÔºÅ</p>';
                return;
            }

            const cardsHtml = playerInventory.map(player => createPlayerCard(player, true)).join('');
            resultContainer.innerHTML = cardsHtml;
        }

        // Êõ¥Êñ∞Â∫ìÂ≠òÊï∞ÈáèÊòæÁ§∫
        function updateInventoryCount() {
            document.getElementById('inventory-count').textContent = playerInventory.length;
        }

        // Âç°ÁâáÁøªËΩ¨
        function flipCard(cardElement) {
            const cardInner = cardElement.querySelector('.card-inner');
            const isFlipped = cardInner.style.transform === 'rotateY(0deg)' || cardInner.style.transform === '';
            
            // Ê∑ªÂä†ÁøªËΩ¨Âä®Áîª
            cardElement.style.pointerEvents = 'none'; // Èò≤Ê≠¢ÈáçÂ§çÁÇπÂáª
            
            if (isFlipped) {
                cardInner.style.transform = 'rotateY(180deg)'; // ÁøªÂà∞ËÉåÈù¢
            } else {
                cardInner.style.transform = 'rotateY(0deg)';   // ÁøªÂà∞Ê≠£Èù¢
            }
            
            // ÈáçÊñ∞ÂêØÁî®ÁÇπÂáª
            setTimeout(() => {
                cardElement.style.pointerEvents = 'auto';
            }, 600);
        }

        // Êõ¥Êñ∞Ë¥ßÂ∏ÅÊòæÁ§∫
        function updateCurrencyDisplay() {
            document.getElementById('coins').textContent = playerCurrency.coins;
            document.getElementById('gems').textContent = playerCurrency.gems;
            document.getElementById('highlight-directed-tickets').textContent = playerCurrency.È´òÂÖâÂÆöÂêëÂç∑;
            document.getElementById('featured-directed-tickets').textContent = playerCurrency.Á≤æÈÄâÂÆöÂêëÂç∑;
            document.getElementById('highlight-tickets').textContent = playerCurrency.È´òÂÖâÂç∑;
            document.getElementById('featured-tickets').textContent = playerCurrency.Á≤æÈÄâÂç∑;
        }

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrencyDisplay();
            updateInventoryCount();
            updatePityCounter();
            
            // ÊØè30ÁßíËá™Âä®‰øùÂ≠ò
            setInterval(() => {
                localStorage.setItem('pesPlayerInventory', JSON.stringify(playerInventory));
                localStorage.setItem('pesCurrency', JSON.stringify(playerCurrency));
                localStorage.setItem('pesFeaturedCounter', featuredGachaCounter.toString());
            }, 30000);
            
            // Âä†ËΩΩ‰øùÂ≠òÁöÑÊï∞ÊçÆ
            const savedInventory = localStorage.getItem('pesPlayerInventory');
            const savedCurrency = localStorage.getItem('pesCurrency');
            const savedCounter = localStorage.getItem('pesFeaturedCounter');
            
            if (savedInventory) {
                playerInventory = JSON.parse(savedInventory);
                updateInventoryCount();
            }
            
            if (savedCurrency) {
                Object.assign(playerCurrency, JSON.parse(savedCurrency));
                updateCurrencyDisplay();
            }
            
            if (savedCounter) {
                featuredGachaCounter = parseInt(savedCounter);
                updatePityCounter();
            }

            // ÂÖÖÂÄºÂäüËÉΩ
            window.showRechargeModal = function() {
                document.getElementById('recharge-modal').style.display = 'flex';
            };

            window.hideRechargeModal = function() {
                document.getElementById('recharge-modal').style.display = 'none';
            };

            window.purchaseTickets = function(ticketType) {
                const packages = {
                    'highlight-directed': {
                        name: 'È´òÂÖâÂÆöÂêëÂç∑',
                        cost: 1000,
                        currency: 'gems',
                        tickets: 10,
                        ticketKey: 'È´òÂÖâÂÆöÂêëÂç∑'
                    },
                    'featured-directed': {
                        name: 'Á≤æÈÄâÂÆöÂêëÂç∑',
                        cost: 1000,
                        currency: 'gems',
                        tickets: 10,
                        ticketKey: 'Á≤æÈÄâÂÆöÂêëÂç∑'
                    },
                    'highlight-normal': {
                        name: 'È´òÂÖâÂç∑',
                        cost: 50000,
                        currency: 'gems',
                        tickets: 10,
                        ticketKey: 'È´òÂÖâÂç∑'
                    },
                    'featured-normal': {
                        name: 'Á≤æÈÄâÂç∑',
                        cost: 50000,
                        currency: 'gems',
                        tickets: 10,
                        ticketKey: 'Á≤æÈÄâÂç∑'
                    }
                };

                const packageInfo = packages[ticketType];
                if (!packageInfo) return;

                // Ê£ÄÊü•Ë¥ßÂ∏ÅÊòØÂê¶Ë∂≥Â§ü
                if (playerCurrency[packageInfo.currency] < packageInfo.cost) {
                    alert(`üíé ÈíªÁü≥‰∏çË∂≥ÔºÅÈúÄË¶Å ${packageInfo.cost} ÈíªÁü≥ÔºåÂΩìÂâçÂè™Êúâ ${playerCurrency[packageInfo.currency]} ÈíªÁü≥„ÄÇ`);
                    return;
                }

                // Á°ÆËÆ§Ë¥≠‰π∞
                const confirmMsg = `Á°ÆËÆ§Ë¥≠‰π∞ ${packageInfo.name}Ôºü\n\nüíé Ê∂àËÄóÔºö${packageInfo.cost} ÈíªÁü≥\nüé´ Ëé∑ÂæóÔºö${packageInfo.tickets} Âº† ${packageInfo.name}\n\nÂΩìÂâçÈíªÁü≥Ôºö${playerCurrency[packageInfo.currency]}`;
                
                if (!confirm(confirmMsg)) return;

                // ÊâßË°åË¥≠‰π∞
                playerCurrency[packageInfo.currency] -= packageInfo.cost;
                
                // Ê∑ªÂä†ÂØπÂ∫îÁöÑÂç∑
                playerCurrency[packageInfo.ticketKey] = (playerCurrency[packageInfo.ticketKey] || 0) + packageInfo.tickets;

                // Êõ¥Êñ∞ÊòæÁ§∫
                updateCurrencyDisplay();
                
                // ‰øùÂ≠òÊï∞ÊçÆ
                localStorage.setItem('pesCurrency', JSON.stringify(playerCurrency));

                // ÊòæÁ§∫Ë¥≠‰π∞ÊàêÂäü
                alert(`üéâ Ë¥≠‰π∞ÊàêÂäüÔºÅ\n\nËé∑Âæó‰∫Ü ${packageInfo.tickets} Âº† ${packageInfo.name}ÔºÅ\nÂâ©‰ΩôÈíªÁü≥Ôºö${playerCurrency[packageInfo.currency]}`);

                // ÂÖ≥Èó≠ÂÖÖÂÄºÁïåÈù¢
                hideRechargeModal();
            };

            // ÁÇπÂáªÂÖÖÂÄºÁïåÈù¢Â§ñÈÉ®ÂÖ≥Èó≠
            document.getElementById('recharge-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    hideRechargeModal();
                }
            });

            // Ê∑ªÂä†ÁÇπÂáªÁõëÂê¨ÔºåÁî®‰∫éÊòæÁ§∫Ë∑≥ËøáÊåâÈíÆ
            document.addEventListener('click', showSkipButton);
            document.addEventListener('keydown', showSkipButton);
            
            // ÂàùÂßãÂåñËÉåÊôØÈü≥‰πê
            initializeBGM();
        });

        // ËÉåÊôØÈü≥‰πêÊéßÂà∂Á≥ªÁªü
        function initializeBGM() {
            // ËÆæÁΩÆÈü≥È¢ëÂü∫Á°ÄÂ±ûÊÄß
            bgmAudio.volume = 0;
            bgmAudio.loop = false;  // ‰∏çÂæ™ÁéØÔºåÊí≠ÊîæÂÆåËá™Âä®ÂàáÊç¢Âà∞‰∏ã‰∏ÄÈ¶ñ
            
            // ÂºÄÂßãÊí≠ÊîæÈöèÊú∫Èü≥‰πê
            playRandomBGM();
            
            // ÁõëÂê¨Èü≥È¢ëÂä†ËΩΩÈîôËØØÔºåËá™Âä®ÂàáÊç¢Âà∞‰∏ã‰∏ÄÈ¶ñ
            bgmAudio.addEventListener('error', () => {
                console.log('Èü≥È¢ëÂä†ËΩΩÂ§±Ë¥•ÔºåÂàáÊç¢Âà∞‰∏ã‰∏ÄÈ¶ñ');
                playRandomBGM();
            });
            
            // ÁõëÂê¨Èü≥È¢ëÁªìÊùüÔºåËá™Âä®Êí≠Êîæ‰∏ã‰∏ÄÈ¶ñÈöèÊú∫Èü≥‰πê
            bgmAudio.addEventListener('ended', () => {
                console.log('Èü≥‰πêÊí≠ÊîæÂÆåÊØïÔºåÂàáÊç¢Âà∞‰∏ã‰∏ÄÈ¶ñÈöèÊú∫Èü≥‰πê');
                playRandomBGM();
            });
        }

        // Êí≠ÊîæÈöèÊú∫ËÉåÊôØÈü≥‰πê
        function playRandomBGM() {
            console.log('Â∞ùËØïÊí≠ÊîæÈöèÊú∫BGM');
            
            if (!bgmAudio) {
                console.error('bgmAudioÂÖÉÁ¥†‰∏çÂ≠òÂú®');
                return;
            }
            
            // ÈöèÊú∫ÈÄâÊã©‰∏ÄÈ¶ñÈü≥‰πêÔºàÁ°Æ‰øù‰∏çÈáçÂ§çÔºâ
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * bgmPlaylist.length);
            } while (newIndex === currentBGMIndex && bgmPlaylist.length > 1);
            
            currentBGMIndex = newIndex;
            
            // ËÆæÁΩÆÈü≥Ê∫ê
            const audioSrc = bgmPlaylist[currentBGMIndex];
            console.log('ËÆæÁΩÆBGMÈü≥Ê∫ê:', audioSrc);
            bgmAudio.src = audioSrc;
            
            // Âä†ËΩΩÈü≥È¢ë
            try {
                bgmAudio.load();
                console.log('BGMÂä†ËΩΩÂÆåÊàêÔºåÂáÜÂ§áÊí≠Êîæ');
                // Ê∑°ÂÖ•Êí≠Êîæ
                fadeInBGM();
            } catch (e) {
                console.log('BGMÂä†ËΩΩÂºÇÂ∏∏:', e);
                isBGMInitialized = false;
            }
        }

        // Ê∑°ÂÖ•ËÉåÊôØÈü≥‰πê
        function fadeInBGM() {
            bgmAudio.volume = 0;
            bgmAudio.play().catch(error => {
                console.log('Èü≥È¢ëÊí≠ÊîæÂ§±Ë¥•:', error);
                // Â¶ÇÊûúÊí≠ÊîæÂ§±Ë¥•ÔºåÂ∞ùËØï‰∏ã‰∏ÄÈ¶ñ
                setTimeout(playRandomBGM, 1000);
                return;
            });
            
            // 2ÁßíÊ∑°ÂÖ•
            const fadeInDuration = 2000;
            const targetVolume = 0.3; // ÁõÆÊ†áÈü≥ÈáèÔºà30%Ôºâ
            const fadeInSteps = 50;
            const stepDuration = fadeInDuration / fadeInSteps;
            const volumeStep = targetVolume / fadeInSteps;
            
            let currentStep = 0;
            
            bgmFadeInterval = setInterval(() => {
                currentStep++;
                const newVolume = Math.min(volumeStep * currentStep, targetVolume);
                bgmAudio.volume = newVolume;
                
                if (currentStep >= fadeInSteps) {
                    clearInterval(bgmFadeInterval);
                    bgmFadeInterval = null;
                }
            }, stepDuration);
        }

        // Ê∑°Âá∫ËÉåÊôØÈü≥‰πê
        function fadeOutBGM(callback) {
            if (bgmFadeInterval) {
                clearInterval(bgmFadeInterval);
                bgmFadeInterval = null;
            }
            
            // 2ÁßíÊ∑°Âá∫
            const fadeOutDuration = 2000;
            const fadeOutSteps = 50;
            const stepDuration = fadeOutDuration / fadeOutSteps;
            const currentVolume = bgmAudio.volume;
            const volumeStep = currentVolume / fadeOutSteps;
            
            let currentStep = 0;
            
            bgmFadeInterval = setInterval(() => {
                currentStep++;
                const newVolume = Math.max(currentVolume - (volumeStep * currentStep), 0);
                bgmAudio.volume = newVolume;
                
                if (currentStep >= fadeOutSteps || newVolume <= 0) {
                    clearInterval(bgmFadeInterval);
                    bgmFadeInterval = null;
                    bgmAudio.pause();
                    
                    if (callback) {
                        callback();
                    }
                }
            }, stepDuration);
        }

        // ÊöÇÂÅúËÉåÊôØÈü≥‰πêÔºàÊäΩÂç°Êó∂Ôºâ
        function pauseBGMForGacha() {
            fadeOutBGM();
        }

        // ÊÅ¢Â§çËÉåÊôØÈü≥‰πêÔºàÊäΩÂç°ÁªìÊùüÂêéÔºâ
        function resumeBGMAfterGacha() {
            // Âª∂Ëøü1ÁßíÂêéÊí≠ÊîæÊñ∞ÁöÑÈöèÊú∫Èü≥‰πê
            setTimeout(() => {
                playRandomBGM();
            }, 1000);
        }

        // ÊäΩÁêÉÈü≥ÊïàÁ≥ªÁªü - ‰ΩøÁî®Web Audio APIÂêàÊàê
        let audioContext = null;
        let drumBeatPattern = null;
        let cheerSoundGain = null;
        let drumGain = null;
        let gachaAudioActive = false;

        // ÂàùÂßãÂåñÈü≥È¢ë‰∏ä‰∏ãÊñá
        function initGachaAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Â¶ÇÊûúÈü≥È¢ë‰∏ä‰∏ãÊñáË¢´ÊöÇÂÅúÔºåÂ∞ùËØïÊÅ¢Â§ç
                if (audioContext.state === 'suspended') {
                    audioContext.resume().then(() => {
                        console.log('Èü≥È¢ë‰∏ä‰∏ãÊñáÂ∑≤ÊÅ¢Â§ç');
                    }).catch(err => {
                        console.log('Èü≥È¢ë‰∏ä‰∏ãÊñáÊÅ¢Â§çÂ§±Ë¥•:', err);
                    });
                }
            }
            return audioContext;
        }

        // ÂàõÂª∫ÈºìÁÇπËäÇÊãç
        function createDrumBeat() {
            const ctx = audioContext;
            const duration = 0.2; // Á®çÂæÆÂª∂ÈïøÈºìÁÇπÊåÅÁª≠Êó∂Èó¥
            
            // ÂàõÂª∫ÈºìÁÇπÈü≥È¢ëÁºìÂÜ≤Âå∫
            const buffer = ctx.createBuffer(1, ctx.sampleRate * duration, ctx.sampleRate);
            const data = buffer.getChannelData(0);
            
            // ÁîüÊàêÊõ¥ÁúüÂÆûÁöÑÈºìÁÇπÂ£∞Èü≥
            for (let i = 0; i < data.length; i++) {
                const t = i / ctx.sampleRate;
                const envelope = Math.exp(-t * 25); // Âø´ÈÄüË°∞ÂáèÂåÖÁªú
                
                // Â∫ïÈºìÈÉ®ÂàÜ - ‰ΩéÈ¢ëÈáçÂáª
                const kickFreq = 50 + Math.sin(t * 100) * 20; // È¢ëÁéáÁï•ÊúâÂèòÂåñ
                const kick = Math.sin(2 * Math.PI * kickFreq * t) * envelope * 0.8;
                
                // ÂÜõÈºìÈÉ®ÂàÜ - ‰∏≠È´òÈ¢ë
                const snareEnv = Math.exp(-t * 40); // Êõ¥Âø´Ë°∞Âáè
                const snare = (Math.random() * 2 - 1) * snareEnv * 0.4; // Âô™Â£∞
                const snareClick = Math.sin(2 * Math.PI * 180 * t) * snareEnv * 0.3;
                
                // È´òÈ¢ëÁÇπÁºÄ
                const hihat = (Math.random() * 2 - 1) * Math.exp(-t * 60) * 0.2;
                
                // Ê∑∑ÂêàÊâÄÊúâÂÖÉÁ¥†
                data[i] = (kick + snare + snareClick + hihat) * 0.9;
            }
            
            return buffer;
        }

        // ÂàõÂª∫Ê¨¢ÂëºÂ£∞ÊïàÊûú - ÁÆÄÂåñÁâàÊú¨
        function createCheerSound() {
            const ctx = audioContext;
            const duration = 3.0;
            const sampleRate = ctx.sampleRate;
            
            // ÂàõÂª∫ÂçïÂ£∞ÈÅìÁºìÂÜ≤Âå∫ÂÖàÊµãËØï
            const buffer = ctx.createBuffer(1, sampleRate * duration, sampleRate);
            const data = buffer.getChannelData(0);
            
            // ÁîüÊàêÁÆÄÂçï‰ΩÜÊúâÊïàÁöÑÊ¨¢ÂëºÂ£∞
            for (let i = 0; i < data.length; i++) {
                const t = i / sampleRate;
                
                // ÁÆÄÂçïÂåÖÁªúÔºöÂâç1ÁßíÊ∏êÂÖ•Ôºå‰∏≠Èó¥1ÁßíÊª°Èü≥ÈáèÔºåÂêé1ÁßíÊ∏êÂá∫
                let envelope;
                if (t < 1) {
                    envelope = t; // Ê∏êÂÖ•
                } else if (t < 2) {
                    envelope = 1; // Êª°Èü≥Èáè
                } else {
                    envelope = 3 - t; // Ê∏êÂá∫
                }
                
                // Âü∫Á°ÄÁôΩÂô™Â£∞
                let sample = (Math.random() * 2 - 1) * 0.4;
                
                // Ê∑ªÂä†Âë®ÊúüÊÄßÂèòÂåñÊ®°Êãü‰∫∫Áæ§Ëµ∑‰ºè
                const crowdWave = Math.sin(2 * Math.PI * 2 * t) * 0.3 + 0.7; // 2HzÂèòÂåñ
                sample *= crowdWave;
                
                // ÂÅ∂Â∞îÁöÑÂº∫ÁÉàÊãçÊâãÊàñÂëºÂñä
                if (Math.random() < 0.02) { // 2%Ê¶ÇÁéá
                    sample += (Math.random() * 2 - 1) * 0.6;
                }
                
                // Â∫îÁî®ÂåÖÁªú
                data[i] = sample * envelope;
            }
            
            console.log('Ê¨¢ÂëºÂ£∞ÁºìÂÜ≤Âå∫ÁîüÊàêÂÆåÊàêÔºåÈïøÂ∫¶:', data.length, 'Ê†∑Êú¨');
            return buffer;
        }

        // ÂºÄÂßãÊäΩÁêÉÈü≥ÊïàÂ∫èÂàó
        function startGachaAudioSequence() {
            try {
                if (!audioContext) {
                    initGachaAudio();
                }
                
                // Á°Æ‰øùÈü≥È¢ë‰∏ä‰∏ãÊñáÂ§Ñ‰∫éËøêË°åÁä∂ÊÄÅ
                if (audioContext.state === 'suspended') {
                    audioContext.resume().then(() => {
                        startGachaAudioSequenceInternal();
                    }).catch(err => {
                        console.log('Êó†Ê≥ïÂêØÂä®Èü≥È¢ëÊïàÊûú:', err);
                    });
                } else {
                    startGachaAudioSequenceInternal();
                }
            } catch (error) {
                console.log('Èü≥ÊïàÁ≥ªÁªüÂàùÂßãÂåñÂ§±Ë¥•:', error);
            }
        }

        function startGachaAudioSequenceInternal() {
            gachaAudioActive = true;
            console.log('ÊäΩÁêÉÈü≥ÊïàÂ∫èÂàóÂºÄÂßã');
            
            // Ëé∑ÂèñHTML audioÂÖÉÁ¥†
            const cheerAudio = document.getElementById('gacha-cheer-audio');
            
            // ÂàõÂª∫ÈºìÁÇπÈü≥È¢ëÁ¥†ÊùêÔºà‰øùÁïôWeb Audio APIÂêàÊàêÁöÑÈºìÁÇπÔºâ
            const drumBuffer = createDrumBeat();
            console.log('ÈºìÁÇπÈü≥È¢ëÁºìÂÜ≤Âå∫ÂàõÂª∫ÂÆåÊàê', drumBuffer);
            
            // ÂàõÂª∫Â¢ûÁõäËäÇÁÇπÁî®‰∫éÈºìÁÇπÈü≥ÈáèÊéßÂà∂
            drumGain = audioContext.createGain();
            drumGain.connect(audioContext.destination);
            console.log('ÈºìÁÇπÈü≥È¢ëËäÇÁÇπËøûÊé•ÂÆåÊàê');
            
            // ÂºÄÂßãÈºìÁÇπËäÇÊãçÂ∫èÂàó
            console.log('ÂºÄÂßãÈºìÁÇπÂ∫èÂàó');
            startDrumPattern(drumBuffer);
            
            // 2ÁßíÂêéÂºÄÂßãÊí≠ÊîæÁúüÂÆûÁöÑÊ¨¢ÂëºÂ£∞Èü≥Êïà
            setTimeout(() => {
                if (gachaAudioActive) {
                    console.log('ÂáÜÂ§áÊí≠ÊîæÁúüÂÆûÊ¨¢ÂëºÂ£∞Èü≥Êïà');
                    playRealCheerSound(cheerAudio);
                }
            }, 4000);
            
            // 3ÁßíÂêéÂºÄÂßãÈºìÁÇπÊ∑°Âá∫
            setTimeout(() => {
                if (gachaAudioActive) {
                    console.log('ÈºìÁÇπÂºÄÂßãÊ∑°Âá∫');
                    fadeOutDrums();
                }
            }, 3000);
            
            // 8ÁßíÂêéÂÆåÂÖ®ÂÅúÊ≠¢
            setTimeout(() => {
                console.log('Èü≥ÊïàÂ∫èÂàóÁªìÊùü');
                stopGachaAudio();
            }, 8000);
        }

        // Êí≠ÊîæÈºìÁÇπËäÇÊãçÊ®°Âºè
        function startDrumPattern(drumBuffer) {
            if (!gachaAudioActive) return;
            
            // Êõ¥ÊøÄÁÉàÁöÑÊ∏∏ÊàèÈ£éÊ†ºËäÇÊãçÊ®°Âºè
            const beatPattern = [
                1.0, 0.3, 0.6, 0.4,  // Âº∫-Âº±-‰∏≠-Âº±
                0.8, 0.3, 0.7, 0.4,  // ‰∏≠Âº∫-Âº±-‰∏≠-Âº±
                1.0, 0.4, 0.8, 0.3,  // Âº∫-Âº±-‰∏≠Âº∫-Âº±
                0.9, 0.3, 0.5, 0.6   // ‰∏≠Âº∫-Âº±-Âº±‰∏≠-‰∏≠
            ];
            let beatIndex = 0;
            let measureCount = 0;
            
            function playBeat() {
                if (!gachaAudioActive) return;
                
                const source = audioContext.createBufferSource();
                source.buffer = drumBuffer;
                source.connect(drumGain);
                
                // ËÆæÁΩÆÈü≥ÈáèÊ†πÊçÆËäÇÊãçÊ®°ÂºèÔºåÂπ∂ÈöèÁùÄÂ∞èËäÇÂ¢ûÂä†Âº∫Â∫¶
                const intensityMultiplier = Math.min(1.2, 1 + measureCount * 0.1);
                drumGain.gain.value = beatPattern[beatIndex] * 0.75 * intensityMultiplier;
                
                source.start();
                
                beatIndex = (beatIndex + 1) % beatPattern.length;
                
                // ÊØèÂÆåÊàê‰∏Ä‰∏™Âæ™ÁéØÁÆó‰∏Ä‰∏™Â∞èËäÇ
                if (beatIndex === 0) {
                    measureCount++;
                }
                
                // ÊØè180ms‰∏Ä‰∏™ËäÇÊãçÔºàÁ∫¶333 BPMÔºåÊõ¥Âø´Êõ¥ÊøÄÁÉàÔºâ
                setTimeout(playBeat, 180);
            }
            
            // ËÆæÁΩÆÂàùÂßãÈü≥Èáè
            drumGain.gain.value = 0.75;
            playBeat();
        }

        // Êí≠ÊîæÊ¨¢ÂëºÂ£∞Â∫èÂàó
        function startCheerSequence(cheerBuffer) {
            if (!gachaAudioActive) return;
            
            const source = audioContext.createBufferSource();
            source.buffer = cheerBuffer;
            source.connect(cheerSoundGain);
            
            // Á°Æ‰øùÂàùÂßãÈü≥Èáè‰∏∫0ÔºåÁÑ∂ÂêéÊ∏êÂÖ•
            cheerSoundGain.gain.setValueAtTime(0, audioContext.currentTime);
            cheerSoundGain.gain.linearRampToValueAtTime(0.8, audioContext.currentTime + 1.0); // 1ÁßíÊ∏êÂÖ•Âà∞ËæÉÈ´òÈü≥Èáè
            
            console.log('ÂºÄÂßãÊí≠ÊîæÊ¨¢ÂëºÂ£∞'); // Ë∞ÉËØï‰ø°ÊÅØ
            source.start(audioContext.currentTime);
        }

        // Êí≠ÊîæÁúüÂÆûÁöÑÊ¨¢ÂëºÂ£∞Èü≥ÊïàÊñá‰ª∂
        function playRealCheerSound(cheerAudio) {
            if (!gachaAudioActive || !cheerAudio) return;
            
            try {
                // ÈáçÁΩÆÈü≥È¢ëÂà∞ÂºÄÂßã‰ΩçÁΩÆ
                cheerAudio.currentTime = 0;
                
                // ËÆæÁΩÆÈü≥ÈáèÂπ∂Ê∏êÂÖ•
                cheerAudio.volume = 0;
                
                // ÂºÄÂßãÊí≠Êîæ
                const playPromise = cheerAudio.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        console.log('ÁúüÂÆûÊ¨¢ÂëºÂ£∞ÂºÄÂßãÊí≠Êîæ');
                        
                        // 1ÁßíÂÜÖÊ∏êÂÖ•Âà∞70%Èü≥Èáè
                        const fadeInInterval = setInterval(() => {
                            if (cheerAudio.volume < 0.7) {
                                cheerAudio.volume = Math.min(0.7, cheerAudio.volume + 0.05);
                            } else {
                                clearInterval(fadeInInterval);
                            }
                        }, 50);
                        
                    }).catch(error => {
                        console.log('Ê¨¢ÂëºÂ£∞Êí≠ÊîæÂ§±Ë¥•:', error);
                    });
                }
            } catch (error) {
                console.log('Ê¨¢ÂëºÂ£∞Êí≠ÊîæÂºÇÂ∏∏:', error);
            }
        }

        // ÈºìÁÇπÊ∑°Âá∫
        function fadeOutDrums() {
            if (drumGain && gachaAudioActive) {
                drumGain.gain.linearRampToValueAtTime(0, audioContext.currentTime + 2);
            }
        }

        // ÂÅúÊ≠¢ÊäΩÁêÉÈü≥Êïà
        function stopGachaAudio() {
            gachaAudioActive = false;
            
            // ÂÅúÊ≠¢Web AudioÂêàÊàêÈü≥È¢ë
            if (drumGain) {
                drumGain.gain.setValueAtTime(0, audioContext.currentTime);
            }
            if (cheerSoundGain) {
                cheerSoundGain.gain.setValueAtTime(0, audioContext.currentTime);
            }
            
            // ÂÅúÊ≠¢ÁúüÂÆûÊ¨¢ÂëºÂ£∞Èü≥È¢ëÊñá‰ª∂
            const cheerAudio = document.getElementById('gacha-cheer-audio');
            if (cheerAudio && !cheerAudio.paused) {
                cheerAudio.pause();
                cheerAudio.currentTime = 0;
            }
        }

        // ÊäΩÂç°Âä®ÁîªÁ≥ªÁªü
        let gachaAnimationActive = false;
        let animationResults = [];
        let animationPoolName = '';
        
        // Âä®ÁîªËøõÂ∫¶ÊéßÂà∂
        let animationStartTime = 0;
        let animationDuration = 8000; // 8ÁßíÊÄªÊó∂Èïø
        let progressInterval = null;
        let animationTimeouts = []; // Â≠òÂÇ®ÊâÄÊúâÁöÑsetTimeout ID

        // ÂêØÂä®ÊäΩÂç°Âä®Áîª
        function startGachaAnimation(times, poolName) {
            if (gachaAnimationActive) return;
            
            gachaAnimationActive = true;
            animationPoolName = poolName;
            
            // Ê∏ÖÁ©∫‰πãÂâçÁöÑÂä®ÁîªÁä∂ÊÄÅ
            clearAnimationTimeouts();
            
            // ÊöÇÂÅúËÉåÊôØÈü≥‰πê
            pauseBGMForGacha();
            
            // ÂÖàËÆ°ÁÆóÊäΩÂç°ÁªìÊûú
            animationResults = calculateGachaResults(times, poolName);
            
            // ÊòæÁ§∫Âä®ÁîªË¶ÜÁõñÂ±Ç
            const overlay = document.getElementById('gacha-animation');
            overlay.style.display = 'block';
            
            // ÈáçÁΩÆË∑≥ËøáÊåâÈíÆÂíåËøõÂ∫¶Êù°
            resetAnimationUI();
            
            // ÂêØÂä®ËøõÂ∫¶Êù°
            startProgressBar();
            
            // ÂêØÂä®ÊäΩÁêÉÈü≥ÊïàÂ∫èÂàó
            startGachaAudioSequence();
            
            // ÂºÄÂßãÂä®ÁîªÂ∫èÂàó - ÊîæÊÖ¢ËäÇÂ•èÔºåÂ¢ûÂä†Ê≤âÊµ∏ÊÑü
            animationTimeouts.push(setTimeout(() => startStadiumAnimation(), 200));      // 0.2s: ‰ΩìËÇ≤Âú∫ÂÖ•Âú∫
            animationTimeouts.push(setTimeout(() => showAtmosphereEffects(), 1200));     // 1.2s: Â¢ûÂä†Ê∞õÂõ¥ÊïàÊûú
            animationTimeouts.push(setTimeout(() => showLightEffects(), 2000));          // 2.0s: ÁÅØÂÖâÊïàÊûú
            animationTimeouts.push(setTimeout(() => showCameraMovement(), 3000));        // 3.0s: Áõ∏Êú∫ËøêÈïú
            animationTimeouts.push(setTimeout(() => showRarityEffects(), 4500));         // 4.5s: Á®ÄÊúâÂ∫¶ÊïàÊûú (ÂàÜÊ≠ßÁÇπ)
            animationTimeouts.push(setTimeout(() => showResultCard(), 6500));            // 6.5s: ÊòæÁ§∫ÁªìÊûúÂç°Áâá
            animationTimeouts.push(setTimeout(() => endAnimation(), 8000));              // 8.0s: ÁªìÊùüÂä®Áîª
        }

        // ÂêØÂä®‰øùÂ∫ïÂä®Áîª
        function startGachaAnimationWithPity(times) {
            // ÊöÇÂÅúËÉåÊôØÈü≥‰πê
            pauseBGMForGacha();
            
            // Â§ÑÁêÜ‰øùÂ∫ïÈÄªËæë
            const guaranteedCount = 10 + Math.floor(Math.random() * 3);
            const results = [];
            
            // ‰øùÂ∫ïÁ≤æÈÄâÁêÉÂëò
            for (let i = 0; i < guaranteedCount; i++) {
                const player = getPlayerByRarity('Á≤æÈÄâ');
                if (player) {
                    const isNew = !playerInventory.some(p => p.ÂßìÂêç === player.ÂßìÂêç);
                    if (isNew) {
                        playerInventory.push({...player, Ëé∑ÂæóÊó∂Èó¥: new Date().toISOString()});
                    }
                    results.push({player, isNew, isPity: true});
                }
            }
            
            // Ââ©‰ΩôÊôÆÈÄöÊäΩÂç°
            const remainingTimes = times - guaranteedCount;
            for (let i = 0; i < remainingTimes; i++) {
                const rarity = getRandomRarity();
                const player = getPlayerByRarity(rarity);
                if (player) {
                    const isNew = !playerInventory.some(p => p.ÂßìÂêç === player.ÂßìÂêç);
                    if (isNew) {
                        playerInventory.push({...player, Ëé∑ÂæóÊó∂Èó¥: new Date().toISOString()});
                    }
                    results.push({player, isNew});
                }
            }

            // ÈáçÁΩÆ‰øùÂ∫ïËÆ°Êï∞Âô®
            featuredGachaCounter = 0;
            guaranteedFeaturedCount += guaranteedCount;
            
            // ËÆæÁΩÆÂä®ÁîªÁªìÊûúÂπ∂ÂêØÂä®Âä®Áîª
            animationResults = results;
            animationPoolName = `Á≤æÈÄâÂç∑Ê±† - ‰øùÂ∫ïËß¶ÂèëÔºÅËé∑Âæó${guaranteedCount}‰∏™Á≤æÈÄâÁêÉÂëò`;
            
            // ÂêØÂä®Âä®ÁîªÔºà‰∏çÂÜçË∞ÉÁî®startGachaAnimationÔºåÁõ¥Êé•ÊâßË°åÂä®ÁîªÈÄªËæëÔºâ
            if (gachaAnimationActive) return;
            
            gachaAnimationActive = true;
            
            // Ê∏ÖÁ©∫‰πãÂâçÁöÑÂä®ÁîªÁä∂ÊÄÅ
            clearAnimationTimeouts();
            
            // ÊòæÁ§∫Âä®ÁîªË¶ÜÁõñÂ±Ç
            const overlay = document.getElementById('gacha-animation');
            overlay.style.display = 'block';
            
            // ÈáçÁΩÆË∑≥ËøáÊåâÈíÆÂíåËøõÂ∫¶Êù°
            resetAnimationUI();
            
            // ÂêØÂä®ËøõÂ∫¶Êù°
            startProgressBar();
            
            // ÂêØÂä®ÊäΩÁêÉÈü≥ÊïàÂ∫èÂàó
            startGachaAudioSequence();
            
            // ÂºÄÂßãÂä®ÁîªÂ∫èÂàó - ‰øùÂ∫ïÂä®Áîª‰πü‰ΩøÁî®Êñ∞Êó∂Èó¥Á∫ø
            animationTimeouts.push(setTimeout(() => startStadiumAnimation(), 200));      // 0.2s: ‰ΩìËÇ≤Âú∫ÂÖ•Âú∫
            animationTimeouts.push(setTimeout(() => showAtmosphereEffects(), 1200));     // 1.2s: Â¢ûÂä†Ê∞õÂõ¥ÊïàÊûú
            animationTimeouts.push(setTimeout(() => showLightEffects(), 2000));          // 2.0s: ÁÅØÂÖâÊïàÊûú
            animationTimeouts.push(setTimeout(() => showCameraMovement(), 3000));        // 3.0s: Áõ∏Êú∫ËøêÈïú
            animationTimeouts.push(setTimeout(() => showRarityEffects(), 4500));         // 4.5s: Á®ÄÊúâÂ∫¶ÊïàÊûú (ÂàÜÊ≠ßÁÇπ)
            animationTimeouts.push(setTimeout(() => showResultCard(), 6500));            // 6.5s: ÊòæÁ§∫ÁªìÊûúÂç°Áâá
            animationTimeouts.push(setTimeout(() => endAnimation(), 8000));              // 8.0s: ÁªìÊùüÂä®Áîª
        }

        // ËÆ°ÁÆóÊäΩÂç°ÁªìÊûú
        function calculateGachaResults(times, poolName) {
            const results = [];
            
            for (let i = 0; i < times; i++) {
                let targetRarity = null;
                
                if (poolName === 'È´òÂÖâÂÆöÂêëÂç∑Ê±†') {
                    const random = Math.random();
                    if (random < 0.001) {
                        targetRarity = '‰º†Â•áÈ´òÂÖâ';
                    } else if (random < 0.01) {
                        targetRarity = 'È´òÂÖâ';
                    }
                } else if (poolName === 'Á≤æÈÄâÂÆöÂêëÂç∑Ê±†') {
                    if (Math.random() < 0.01) {
                        targetRarity = 'Á≤æÈÄâ';
                    }
                } else if (poolName === 'È´òÂÖâÂç∑Ê±†') {
                    const random = Math.random();
                    if (random < 0.01) {
                        targetRarity = '‰º†Â•áÈ´òÂÖâ';
                    } else if (random < 0.10) {
                        targetRarity = 'È´òÂÖâ';
                    }
                } else if (poolName === 'Á≤æÈÄâÂç∑Ê±†') {
                    if (Math.random() < 0.04) {
                        targetRarity = 'Á≤æÈÄâ';
                    }
                }
                
                if (!targetRarity) {
                    targetRarity = getRandomRarity();
                }
                
                const player = getPlayerByRarity(targetRarity);
                if (player) {
                    const isNew = !playerInventory.some(p => p.ÂßìÂêç === player.ÂßìÂêç);
                    if (isNew) {
                        playerInventory.push({...player, Ëé∑ÂæóÊó∂Èó¥: new Date().toISOString()});
                    }
                    results.push({player, isNew});
                }
            }
            
            return results;
        }

        // ÂºÄÂßã‰ΩìËÇ≤Âú∫Âä®Áîª
        function startStadiumAnimation() {
            // ÁºìÊÖ¢ÂàõÂª∫ÂàùÂßãÁ≤íÂ≠êÊïàÊûú
            createParticles();
            
            // Ê∑ªÂä†‰ΩìËÇ≤Âú∫ÊÖ¢ÊÖ¢ÊòæÁé∞ÁöÑÊïàÊûú
            const stadium = document.getElementById('stadium-animation');
            stadium.style.animation = 'stadiumZoom 3s ease-out forwards';
            
            // Âª∂ËøüÊ∑ªÂä†ÂàùÂßãÈü≥ÊïàÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâ
            setTimeout(() => {
                // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†‰ΩìËÇ≤Âú∫ÂÖ•Âú∫Èü≥Êïà
                console.log('‰ΩìËÇ≤Âú∫Âä®ÁîªÂºÄÂßã - ËøõÂú∫Èò∂ÊÆµ');
            }, 500);
        }

        // ÊòæÁ§∫ÁÅØÂÖâÊïàÊûú
        function showLightEffects() {
            const lightsContainer = document.getElementById('stadium-lights');
            const bestRarity = getBestRarity(animationResults);
            const rarityCount = getRarityCount(animationResults);
            
            // Âà§Êñ≠ÊòØÂê¶‰∏∫Èì∂Ê≤≥ÁâπÊïà
            const isGalaxy = rarityCount >= 2;
            const rarityClass = isGalaxy ? 'rarity-galaxy' : getRarityClass(bestRarity);
            
            // ÂàõÂª∫ÁÅØÂ∏¶ - Êõ¥Âçé‰∏ΩÁöÑÁºìÊÖ¢Â∫èÂàó
            const positions = ['top', 'right', 'bottom', 'left'];
            positions.forEach((pos, index) => {
                setTimeout(() => {
                    const lightStrip = document.createElement('div');
                    lightStrip.className = `light-strip ${pos} ${rarityClass}`;
                    lightsContainer.appendChild(lightStrip);
                    
                    // Ê∑ªÂä†È¢ùÂ§ñÁöÑÂÖâÁéØÊïàÊûú - Âª∂ÈïøÊó∂Èó¥
                    if (isGalaxy || bestRarity === '‰º†Â•áÈ´òÂÖâ') {
                        setTimeout(() => createEnergyRing(rarityClass), 400);
                    }
                }, index * 300); // ‰ªé150msÊîπ‰∏∫300msÔºåÊõ¥ÁºìÊÖ¢
            });
            
            // LED ÂÉèÁ¥†ÊïàÊûú - Âª∂ÂêéËß¶Âèë
            setTimeout(() => showLEDEffect(rarityClass), 1200); // ‰ªé600msÊîπ‰∏∫1200ms
            
            // ÊøÄÂÖâÊùüÊïàÊûúÔºàÈ´òÁ®ÄÊúâÂ∫¶Ôºâ- Âª∂ÂêéËß¶Âèë
            if (bestRarity === 'È´òÂÖâ' || bestRarity === '‰º†Â•áÈ´òÂÖâ' || isGalaxy) {
                setTimeout(() => createLaserBeams(rarityClass), 1600); // ‰ªé800msÊîπ‰∏∫1600ms
            }
        }

        // Â¢ûÂä†Ê∞õÂõ¥ÊïàÊûú - Êñ∞Â¢ûÂäüËÉΩ
        function showAtmosphereEffects() {
            const stadium = document.getElementById('stadium-animation');
            
            // Ê∑ªÂä†ËΩªÂæÆÁöÑ‰ΩìËÇ≤Âú∫ÈúáÂä®ÊïàÊûú
            stadium.style.animation = 'stadiumVibration 2s ease-in-out';
            
            // ÂàõÂª∫ËßÇ‰ºóÊ¨¢ÂëºÁöÑÁ≤íÂ≠êÊïàÊûú
            createCheerParticles();
            
            // Ê∑ªÂä†ÁéØÂ¢ÉÂÖâÊïàÊûú
            createAmbientLighting();
        }

        // Áõ∏Êú∫ËøêÈïúÊïàÊûú - Êñ∞Â¢ûÂäüËÉΩ
        function showCameraMovement() {
            const stadium = document.getElementById('stadium-animation');
            
            // Ê∑ªÂä†Áõ∏Êú∫ÁºìÊÖ¢Êé®ËøõÊïàÊûú
            stadium.style.animation = 'cameraZoomIn 1.5s ease-out forwards';
            
            // ÂàõÂª∫ÊôØÊ∑±ÊïàÊûú
            createDepthOfField();
        }

        // ÊòæÁ§∫Á®ÄÊúâÂ∫¶ÁâπÊïà
        function showRarityEffects() {
            const bestRarity = getBestRarity(animationResults);
            const rarityCount = getRarityCount(animationResults);
            
            // ÁÉüËä±ÁâπÊïà
            if (rarityCount >= 2 || bestRarity === '‰º†Â•áÈ´òÂÖâ') {
                createSuperFireworks();
            } else if (bestRarity === 'È´òÂÖâ' || bestRarity === 'Á≤æÈÄâ') {
                createFireworks();
            }
            
            // Ë∂ÖÁ∫ßÁâπÊïà
            if (rarityCount >= 3 || bestRarity === '‰º†Â•áÈ´òÂÖâ') {
                createMegaEffect();
            }
        }

        // ÊòæÁ§∫ÁªìÊûúÂç°Áâá
        function showResultCard() {
            const showcase = document.getElementById('result-showcase');
            const bestPlayer = getBestPlayer(animationResults);
            
            if (bestPlayer) {
                const cardHtml = createPlayerCard(bestPlayer.player);
                const cardElement = document.createElement('div');
                cardElement.innerHTML = cardHtml;
                const card = cardElement.firstChild;
                card.classList.add('best-player-card');
                
                // Ê∑ªÂä†ÁºìÊÖ¢ÂÖ•Âú∫ÊïàÊûú
                card.style.transform = 'scale(0.3) rotateY(90deg)';
                card.style.opacity = '0';
                card.style.transition = 'all 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
                
                showcase.appendChild(card);
                
                // Âª∂ËøüÊòæÁ§∫Âç°Áâá
                setTimeout(() => {
                    card.style.transform = 'scale(1) rotateY(0deg)';
                    card.style.opacity = '1';
                }, 100);
                
                // Ê∑ªÂä†Âç°ÁâáÂÖâÁéØÊïàÊûú
                setTimeout(() => {
                    card.style.boxShadow = '0 0 50px rgba(255, 215, 0, 0.6), 0 0 100px rgba(255, 215, 0, 0.3)';
                }, 800);
            }
        }

        // ÁªìÊùüÂä®Áîª
        function endAnimation() {
            // Ê∏ÖÁêÜÂä®ÁîªÁä∂ÊÄÅ
            clearAnimationTimeouts();
            
            setTimeout(() => {
                const overlay = document.getElementById('gacha-animation');
                overlay.style.display = 'none';
                
                // ÊòæÁ§∫Ê≠£Â∏∏ÁöÑÊäΩÂç°ÁªìÊûú
                displayGachaResults(animationResults, animationPoolName);
                updateCurrencyDisplay();
                updateInventoryCount();
                updatePityCounter();
                
                // Ê∏ÖÁêÜÂä®ÁîªÂÖÉÁ¥†
                cleanupAnimation();
                gachaAnimationActive = false;
                
                // ÊÅ¢Â§çËÉåÊôØÈü≥‰πêÔºàÊí≠ÊîæÊñ∞ÁöÑÈöèÊú∫Èü≥‰πêÔºâ
                resumeBGMAfterGacha();
            }, 1000);
        }

        // ËøõÂ∫¶Êù°ÊéßÂà∂ÂáΩÊï∞
        function startProgressBar() {
            animationStartTime = Date.now();
            const progressBar = document.getElementById('animation-progress-bar');
            const progressGlow = document.getElementById('animation-progress-glow');
            
            // ÊòæÁ§∫ÂÖâÊôïÊïàÊûú
            progressGlow.style.opacity = '1';
            
            // ÂêØÂä®ËøõÂ∫¶Êõ¥Êñ∞Âæ™ÁéØ
            progressInterval = setInterval(() => {
                const elapsed = Date.now() - animationStartTime;
                const progress = Math.min((elapsed / animationDuration) * 100, 100);
                
                progressBar.style.width = progress + '%';
                progressGlow.style.left = (progress - 2) + '%'; // ÂÖâÊôïÁ®çÂæÆÂÅèÂ∑¶
                
                // Ê†πÊçÆËøõÂ∫¶ÊîπÂèòËøõÂ∫¶Êù°È¢úËâ≤ÂíåÈò∂ÊÆµ
                updateProgressBarStage(progressBar, progress);
                
                // ÂΩìËøõÂ∫¶Ë∂ÖËøá25%Êó∂Ëá™Âä®ÊòæÁ§∫Ë∑≥ËøáÊåâÈíÆ
                if (progress >= 25) {
                    showSkipButton();
                }
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    progressInterval = null;
                }
            }, 50); // ÊØè50msÊõ¥Êñ∞‰∏ÄÊ¨°
        }

        function updateProgressBarStage(progressBar, progress) {
            // Ê∏ÖÈô§ÊâÄÊúâÈò∂ÊÆµÁ±ª
            progressBar.className = 'animation-progress-bar';
            
            if (progress >= 81.25) { // 6.5s/8s = 81.25% (ÁªìÊûúÊòæÁ§∫)
                progressBar.classList.add('stage-result');
            } else if (progress >= 56.25) { // 4.5s/8s = 56.25% (Á®ÄÊúâÂ∫¶ÊïàÊûú)
                progressBar.classList.add('stage-rarity');
            } else if (progress >= 37.5) { // 3.0s/8s = 37.5% (Áõ∏Êú∫ËøêÈïú)
                progressBar.classList.add('stage-camera');
            } else if (progress >= 25) { // 2.0s/8s = 25% (ÁÅØÂÖâÊïàÊûú)
                progressBar.classList.add('stage-lights');
            } else if (progress >= 15) { // 1.2s/8s = 15% (Ê∞õÂõ¥ÊïàÊûú)
                progressBar.classList.add('stage-atmosphere');
            }
            // ÈªòËÆ§Èò∂ÊÆµ‰øùÊåÅÂéüÊù•ÁöÑËìùËâ≤
        }

        function resetAnimationUI() {
            // ÈáçÁΩÆË∑≥ËøáÊåâÈíÆ
            const skipButton = document.getElementById('skip-button');
            skipButton.style.opacity = '0';
            skipButton.style.transform = 'translateY(50px)';
            
            // ÈáçÁΩÆËøõÂ∫¶Êù°
            const progressBar = document.getElementById('animation-progress-bar');
            const progressGlow = document.getElementById('animation-progress-glow');
            progressBar.style.width = '0%';
            progressGlow.style.opacity = '0';
            progressGlow.style.left = '0%';
        }

        function clearAnimationTimeouts() {
            // Ê∏ÖÈô§ÊâÄÊúâÁöÑsetTimeout
            animationTimeouts.forEach(timeoutId => {
                clearTimeout(timeoutId);
            });
            animationTimeouts = [];
            
            // ÂÅúÊ≠¢ËøõÂ∫¶Êù°
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
            
            // ÂÅúÊ≠¢ÊäΩÁêÉÈü≥Êïà
            stopGachaAudio();
        }

        // Ë∑≥ËøáÂä®Áîª
        function skipGachaAnimation() {
            if (!gachaAnimationActive) return;
            
            // Ê∏ÖÈô§ÊâÄÊúâÊú™ÂÆåÊàêÁöÑÂä®Áîª
            clearAnimationTimeouts();
            
            // Á´ãÂç≥ÊÅ¢Â§çÈü≥‰πê
            resumeBGMAfterGacha();
            
            // Á´ãÂç≥ÁªìÊùüÂä®Áîª
            endAnimation();
        }

        // ÊòæÁ§∫Ë∑≥ËøáÊåâÈíÆ
        function showSkipButton() {
            if (!gachaAnimationActive) return;
            
            const skipButton = document.getElementById('skip-button');
            
            // Èò≤Ê≠¢ÈáçÂ§çËß¶ÂèëÂä®Áîª
            if (skipButton.style.opacity !== '0' && skipButton.style.opacity !== '') {
                return;
            }
            
            skipButton.style.animation = 'skipButtonAppear 0.5s ease-out forwards';
        }

        // Ëé∑ÂèñÊúÄ‰Ω≥Á®ÄÊúâÂ∫¶
        function getBestRarity(results) {
            const rarityOrder = ['ÊôÆÂç°', 'Ê¢¶ÂπªÁ≤æÈÄâ', 'Á≤æÈÄâ', 'È´òÂÖâ', '‰º†Â•áÈ´òÂÖâ'];
            let bestRarity = 'ÊôÆÂç°';
            
            results.forEach(result => {
                const currentIndex = rarityOrder.indexOf(result.player.Á®ÄÊúâÂ∫¶);
                const bestIndex = rarityOrder.indexOf(bestRarity);
                if (currentIndex > bestIndex) {
                    bestRarity = result.player.Á®ÄÊúâÂ∫¶;
                }
            });
            
            return bestRarity;
        }

        // Ëé∑ÂèñÁâπËâ≤Âç°Êï∞Èáè
        function getRarityCount(results) {
            return results.filter(result => 
                ['Á≤æÈÄâ', 'È´òÂÖâ', '‰º†Â•áÈ´òÂÖâ'].includes(result.player.Á®ÄÊúâÂ∫¶)
            ).length;
        }

        // Ëé∑ÂèñÊúÄ‰Ω≥ÁêÉÂëò
        function getBestPlayer(results) {
            const rarityOrder = ['ÊôÆÂç°', 'Ê¢¶ÂπªÁ≤æÈÄâ', 'Á≤æÈÄâ', 'È´òÂÖâ', '‰º†Â•áÈ´òÂÖâ'];
            let bestPlayer = results[0];
            
            results.forEach(result => {
                const currentIndex = rarityOrder.indexOf(result.player.Á®ÄÊúâÂ∫¶);
                const bestIndex = rarityOrder.indexOf(bestPlayer.player.Á®ÄÊúâÂ∫¶);
                if (currentIndex > bestIndex) {
                    bestPlayer = result;
                }
            });
            
            return bestPlayer;
        }

        // Ëé∑ÂèñÁ®ÄÊúâÂ∫¶Ê†∑ÂºèÁ±ª
        function getRarityClass(rarity) {
            const rarityClasses = {
                'ÊôÆÂç°': 'rarity-normal',
                'Ê¢¶ÂπªÁ≤æÈÄâ': 'rarity-dream',
                'Á≤æÈÄâ': 'rarity-featured',
                'È´òÂÖâ': 'rarity-highlight',
                '‰º†Â•áÈ´òÂÖâ': 'rarity-legend'
            };
            return rarityClasses[rarity] || 'rarity-normal';
        }

        // ÂàõÂª∫Á≤íÂ≠êÊïàÊûú
        function createParticles() {
            const container = document.querySelector('.stadium-container');
            
            // Â¢ûÂä†Á≤íÂ≠êÊï∞ÈáèÂπ∂Âª∂ÈïøÂàõÂª∫Êó∂Èó¥
            for (let i = 0; i < 80; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 4 + 's'; // Âª∂ÈïøÂä®ÁîªÂª∂Ëøü
                    particle.style.animationDuration = (2 + Math.random() * 3) + 's'; // ÈöèÊú∫Âä®ÁîªÊó∂Èïø
                    container.appendChild(particle);
                    
                    // 5ÁßíÂêéÁßªÈô§Á≤íÂ≠ê - Âª∂ÈïøÁîüÂëΩÂë®Êúü
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 5000);
                }, i * 80); // ‰ªé50msÊîπ‰∏∫80msÔºåÊõ¥ÁºìÊÖ¢ÂàõÂª∫
            }
        }

        // ÂàõÂª∫Ê¨¢ÂëºÁ≤íÂ≠êÊïàÊûú - Êñ∞Â¢ûÂäüËÉΩ
        function createCheerParticles() {
            const container = document.querySelector('.stadium-container');
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'cheer-particle';
                    particle.style.cssText = `
                        position: absolute;
                        width: 6px;
                        height: 6px;
                        background: radial-gradient(circle, #ffeb3b, #ff9800);
                        border-radius: 50%;
                        left: ${Math.random() * 100}%;
                        top: 60%;
                        animation: cheerParticle 2s ease-out forwards;
                        --random-x: ${(Math.random() - 0.5) * 100}px;
                        box-shadow: 0 0 6px rgba(255, 235, 59, 0.8);
                        z-index: 5;
                    `;
                    container.appendChild(particle);
                    
                    // 2ÁßíÂêéÁßªÈô§Á≤íÂ≠ê
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 2000);
                }, i * 60);
            }
        }

        // ÂàõÂª∫ÁéØÂ¢ÉÂÖâÊïàÊûú - Êñ∞Â¢ûÂäüËÉΩ
        function createAmbientLighting() {
            const container = document.querySelector('.stadium-container');
            
            const ambientLight = document.createElement('div');
            ambientLight.className = 'ambient-light';
            ambientLight.style.cssText = `
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(ellipse 80% 60% at 50% 40%, 
                    rgba(255, 255, 255, 0.1) 0%, 
                    rgba(135, 206, 250, 0.05) 30%, 
                    transparent 70%);
                animation: ambientPulse 3s ease-in-out infinite;
                pointer-events: none;
                z-index: 1;
            `;
            container.appendChild(ambientLight);
            
            // 5ÁßíÂêéÁßªÈô§ÁéØÂ¢ÉÂÖâ
            setTimeout(() => {
                if (ambientLight.parentNode) {
                    ambientLight.parentNode.removeChild(ambientLight);
                }
            }, 5000);
        }

        // ÂàõÂª∫ÊôØÊ∑±ÊïàÊûú - Êñ∞Â¢ûÂäüËÉΩ
        function createDepthOfField() {
            const stadium = document.getElementById('stadium-animation');
            
            // Ê∑ªÂä†ÊôØÊ∑±Ê®°Á≥äËæπÁºò
            const depthOverlay = document.createElement('div');
            depthOverlay.className = 'depth-overlay';
            depthOverlay.style.cssText = `
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(ellipse 60% 50% at 50% 50%, 
                    transparent 30%, 
                    rgba(0, 0, 0, 0.1) 70%, 
                    rgba(0, 0, 0, 0.3) 100%);
                pointer-events: none;
                z-index: 3;
                opacity: 0;
                transition: opacity 1.5s ease-out;
            `;
            stadium.appendChild(depthOverlay);
            
            // Ê∏êÊòæÊôØÊ∑±ÊïàÊûú
            setTimeout(() => {
                depthOverlay.style.opacity = '1';
            }, 100);
            
            // 3ÁßíÂêéÁßªÈô§ÊôØÊ∑±ÊïàÊûú
            setTimeout(() => {
                if (depthOverlay.parentNode) {
                    depthOverlay.parentNode.removeChild(depthOverlay);
                }
            }, 3000);
        }

        // ÊòæÁ§∫LEDÊïàÊûú
        function showLEDEffect(rarityClass) {
            const ledContainer = document.getElementById('stadium-led');
            
            for (let i = 0; i < 200; i++) {
                setTimeout(() => {
                    const ledPixel = document.createElement('div');
                    ledPixel.className = `led-pixel ${rarityClass}`;
                    ledPixel.style.left = Math.random() * 100 + '%';
                    ledPixel.style.top = Math.random() * 100 + '%';
                    ledPixel.style.animationDelay = Math.random() * 1 + 's';
                    ledContainer.appendChild(ledPixel);
                }, i * 10);
            }
        }

        // ÂàõÂª∫Ë∂ÖÁ∫ßÁÉüËä±ÊïàÊûú
        function createSuperFireworks() {
            const fireworksContainer = document.getElementById('fireworks');
            const colors = ['#ff1493', '#ffd700', '#00bfff', '#ff8c00', '#8a2be2', '#ff6b6b', '#00ff80'];
            
            // Â§öÂ±ÇÁÉüËä±ÁàÜÁÇ∏
            for (let layer = 0; layer < 3; layer++) {
                setTimeout(() => {
                    for (let i = 0; i < 30; i++) {
                        setTimeout(() => {
                            const firework = document.createElement('div');
                            firework.className = 'firework';
                            firework.style.left = Math.random() * 100 + '%';
                            firework.style.top = Math.random() * 60 + '%';
                            firework.style.background = colors[Math.floor(Math.random() * colors.length)];
                            firework.style.animationDelay = Math.random() * 0.5 + 's';
                            firework.style.animationDuration = (1.5 + Math.random()) + 's';
                            fireworksContainer.appendChild(firework);
                            
                            // 2ÁßíÂêéÁßªÈô§ÁÉüËä±
                            setTimeout(() => {
                                if (firework.parentNode) {
                                    firework.parentNode.removeChild(firework);
                                }
                            }, 2500);
                        }, i * 50);
                    }
                }, layer * 800);
            }
        }

        // ÂàõÂª∫ÊôÆÈÄöÁÉüËä±ÊïàÊûú
        function createFireworks() {
            const fireworksContainer = document.getElementById('fireworks');
            const colors = ['#ff6b6b', '#ffd700', '#00bfff', '#ff8c00', '#8a2be2'];
            
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.className = 'firework';
                    firework.style.left = Math.random() * 100 + '%';
                    firework.style.top = Math.random() * 50 + '%';
                    firework.style.background = colors[Math.floor(Math.random() * colors.length)];
                    firework.style.animationDelay = Math.random() * 0.5 + 's';
                    fireworksContainer.appendChild(firework);
                    
                    setTimeout(() => {
                        if (firework.parentNode) {
                            firework.parentNode.removeChild(firework);
                        }
                    }, 2000);
                }, i * 100);
            }
        }

        // ÂàõÂª∫ÊøÄÂÖâÊùüÊïàÊûú
        function createLaserBeams(rarityClass) {
            const laserContainer = document.getElementById('laser-container');
            
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const laser = document.createElement('div');
                    laser.className = `laser-beam ${rarityClass}`;
                    laser.style.left = Math.random() * 100 + '%';
                    laser.style.animationDelay = Math.random() * 2 + 's';
                    laserContainer.appendChild(laser);
                    
                    setTimeout(() => {
                        if (laser.parentNode) {
                            laser.parentNode.removeChild(laser);
                        }
                    }, 3000);
                }, i * 200);
            }
        }

        // ÂàõÂª∫ËÉΩÈáèÁéØÊïàÊûú
        function createEnergyRing(rarityClass) {
            const energyContainer = document.getElementById('energy-container');
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const ring = document.createElement('div');
                    ring.className = `energy-ring ${rarityClass}`;
                    ring.style.animationDelay = i * 0.3 + 's';
                    energyContainer.appendChild(ring);
                    
                    setTimeout(() => {
                        if (ring.parentNode) {
                            ring.parentNode.removeChild(ring);
                        }
                    }, 2000);
                }, i * 400);
            }
        }

        // ÂàõÂª∫Ë∂ÖÁ∫ßÁâπÊïà
        function createMegaEffect() {
            // Â±èÂπïÈúáÂä®ÊïàÊûú
            const overlay = document.getElementById('gacha-animation');
            overlay.style.animation = 'screenShake 0.5s ease-in-out 3';
            
            // ÂàõÂª∫Ë∂ÖÁ∫ßÁ≤íÂ≠ê
            createSuperParticles();
            
            // ÂÖ®Â±èÈó™ÂÖâ
            createScreenFlash();
        }

        // ÂàõÂª∫Ë∂ÖÁ∫ßÁ≤íÂ≠ê
        function createSuperParticles() {
            const container = document.querySelector('.stadium-container');
            
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.background = `hsl(${Math.random() * 360}, 100%, 70%)`;
                    particle.style.animationDelay = Math.random() * 2 + 's';
                    particle.style.animationDuration = (2 + Math.random() * 2) + 's';
                    container.appendChild(particle);
                    
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 4000);
                }, i * 30);
            }
        }

        // ÂàõÂª∫ÂÖ®Â±èÈó™ÂÖâ
        function createScreenFlash() {
            const flash = document.createElement('div');
            flash.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
                z-index: 9998;
                pointer-events: none;
                animation: screenFlash 0.5s ease-out forwards;
            `;
            
            document.body.appendChild(flash);
            
            setTimeout(() => {
                if (flash.parentNode) {
                    flash.parentNode.removeChild(flash);
                }
            }, 500);
        }

        // Ê∏ÖÁêÜÂä®ÁîªÂÖÉÁ¥†
        function cleanupAnimation() {
            // Ê∏ÖÁêÜÁÅØÂÖâ
            const lightsContainer = document.getElementById('stadium-lights');
            lightsContainer.innerHTML = '';
            
            // Ê∏ÖÁêÜLED
            const ledContainer = document.getElementById('stadium-led');
            ledContainer.innerHTML = '';
            
            // Ê∏ÖÁêÜÁÉüËä±
            const fireworksContainer = document.getElementById('fireworks');
            fireworksContainer.innerHTML = '';
            
            // Ê∏ÖÁêÜÊøÄÂÖâ
            const laserContainer = document.getElementById('laser-container');
            laserContainer.innerHTML = '';
            
            // Ê∏ÖÁêÜËÉΩÈáèÁéØ
            const energyContainer = document.getElementById('energy-container');
            energyContainer.innerHTML = '';
            
            // Ê∏ÖÁêÜÂ±ïÁ§∫Âå∫
            const showcase = document.getElementById('result-showcase');
            showcase.innerHTML = '';
            
            // Ê∏ÖÁêÜÁ≤íÂ≠ê
            const particles = document.querySelectorAll('.particle');
            particles.forEach(particle => {
                if (particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            });
        }
    </script>
</body>
</html>
